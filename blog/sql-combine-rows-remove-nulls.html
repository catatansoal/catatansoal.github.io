<!DOCTYPE html>
<html lang="en">
<head>
	<title>SQL: Combine Rows, Remove Nulls &amp; Swap Values</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SQL: Combine Rows, Remove Nulls & Swap Values...">
    <link rel="canonical" href="https://catatansoal.github.io/blog/sql-combine-rows-remove-nulls">
	<meta property="og:type" content="article">
	<meta property="og:title" content="SQL: Combine Rows, Remove Nulls &amp; Swap Values">
	<meta property="og:description" content="SQL: Combine Rows, Remove Nulls & Swap Values...">
	<meta property="og:url" content="https://catatansoal.github.io/blog/sql-combine-rows-remove-nulls">
	<meta property="og:site_name" content="Question Notes">
	<meta property="article:published_time" content="2025-08-06T11:52:33+00:00">
	<meta property="article:author" content="ADMIN">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js">
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <link rel="preload" fetchpriority="high" as="image" href="https://tse4.mm.bing.net/th?q=Combine%20Rows%20to%20Remove%20Nulls%20or%20Swap%20Values%20in%20SQL%20Server">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style type="text/css">
    	:root{--primary-color:#3740ff;--text-color:#202124;--background-color:#ffffff;--gray-100:#f8f9fa;--gray-200:#e9ecef}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.6;color:var(--text-color);background-color:var(--background-color)}.container{max-width:1200px;margin:0 auto;padding:0 1.5rem}.header{background-color:var(--background-color);border-bottom:1px solid var(--gray-200);position:sticky;top:0;z-index:100}.nav{padding:.5rem 0}.nav-container{display:flex;justify-content:space-between;align-items:center;gap:1rem}.nav-left{display:flex;align-items:center;flex-shrink:0}.logo{font-weight:700;color:var(--primary-color)}.blog-tag{margin-left:1rem;padding:.25rem .5rem;background-color:var(--gray-100);border-radius:4px;font-size:.875rem}.nav-search{flex-grow:1;max-width:300px}.search-form{position:relative;width:100%}.search-input{width:100%;padding:.5rem 2.5rem .5rem 1rem;border:1px solid var(--gray-200);border-radius:24px;font-size:.875rem;transition:all 0.2s}.search-input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgb(55 64 255 / .1)}.search-button{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#5f6368;cursor:pointer;padding:.25rem;display:flex;align-items:center;justify-content:center}.search-button:hover{color:var(--primary-color)}.nav-toggle{display:none;background:none;border:none;cursor:pointer;padding:.5rem}.hamburger{display:block;position:relative;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before,.hamburger::after{content:'';position:absolute;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before{top:-6px}.hamburger::after{bottom:-6px}.nav-toggle-active .hamburger{background:#fff0}.nav-toggle-active .hamburger::before{transform:rotate(45deg);top:0}.nav-toggle-active .hamburger::after{transform:rotate(-45deg);bottom:0}.nav-list{display:flex;list-style:none;gap:2rem}.nav-link{color:var(--text-color);text-decoration:none;font-size:.9rem;transition:color 0.2s}.nav-link:hover{color:var(--primary-color)}.article-header{padding:2rem 0;background-color:var(--gray-100)}.article-layout{display:grid;grid-template-columns:1fr 350px;gap:3rem;padding:1rem 0;align-items: start}h1,h2,h3,h4,h5,h6{font-family:"Crimson Text","Times New Roman",Times,serif}h1{font-size:2.5rem;line-height:1.2;margin-bottom:1rem}.meta{color:#5f6368;font-size:.875rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.view-count{display:inline-flex;align-items:center;gap:.25rem}.view-count svg{color:#5f6368}.content{min-width:0;border-bottom:1px solid #dddddd5e;margin-top:1rem;white-space:pre-line !important;overflow-wrap:break-word;overflow-x:auto;word-break:break-word}.lead{font-size:1.25rem;color:#5f6368;margin-bottom:2rem}h2,h3,h4,h5,h6{font-size:1.75rem;margin:1rem 0 1rem}p,pre,ol,ul>li{margin-bottom:1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;font-size:1.3rem;text-align: justify;}p>code{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px}hr{margin:1rem 0 1rem 0}.code-example{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;margin:1.5rem 0;overflow-x:auto}code{font-family:'Roboto Mono',monospace;font-size:.875rem}ul{margin:.2rem 0;padding-left:1.5rem}.related-posts{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;position:sticky;top:5rem}.related-posts-title,.newpost-posts-list{font-size:1.75rem;margin:0 0 1rem}.related-posts-list{display:flex;flex-direction:column;gap:.5rem}.related-post,.newpost-post{border-bottom:1px solid #ddd;padding-bottom:10px;margin-bottom:10px}.related-post:last-child,.newpost-post:last-child{padding-bottom:0;border-bottom:none}.related-post-title,.newpost-post-title{font-size:1.2rem;margin:0 0 .1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;}.related-post-title a,.newpost-post-title a{color:var(--text-color);text-decoration:none;transition:color 0.2s}.related-post-title a:hover,.newpost-post-title a:hover{color:var(--primary-color)}.related-post time{font-size:.875rem;color:#5f6368}.footer{background-color:var(--gray-100);padding:2rem 0;margin-top:4rem;color:#5f6368;font-size:.875rem}.nav-menu>ul>li{margin-bottom:0}@media (max-width:1024px){.container{max-width:800px}.article-layout{grid-template-columns:1fr;gap:2rem}.related-posts{position:static}}@media (max-width:768px){.nav-container{flex-wrap:wrap}.nav-search{order:3;max-width:none;width:100%;margin-top:.1rem}.nav-toggle{display:block}.nav-menu{display:none;position:absolute;top:100%;left:0;right:0;background:var(--background-color);padding:1rem 0;border-bottom:1px solid var(--gray-200)}.nav-menu-active{display:block}.nav-list{flex-direction:column;gap:.1rem;padding:0 1.5rem}.nav-link{display:block;padding:.2rem 0}h1{font-size:2rem}.article-header{padding:2rem 0}.content{padding:.1rem 0}}table{width:100%;border-collapse:collapse;margin:20px 0;font-family:'Arial',sans-serif}th,td{padding:12px 15px;text-align:left;border:1px solid #ddd}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9}tr:nth-child(even) td{background-color:#f2f2f2}@media screen and (max-width:768px){table{border:0;display:block;overflow-x:auto;white-space:nowrap}th,td{padding:10px;text-align:right}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9;border-bottom:1px solid #ddd}tr:nth-child(even) td{background-color:#f2f2f2}}a{text-decoration:none;color:#540707}.katex-html{padding: .2rem;color: #000;font-weight: 700;font-size: 1.3rem;overflow-wrap: break-word;max-width: 100%;white-space: normal !important}.category{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;margin:1rem 0 1rem 0}.tag{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px;font-family:"Newsreader",serif}.tag>a{text-decoration:none;color:#000}img{margin:auto;display:block;max-width:100%;height:auto;margin-bottom:1rem}.katex{white-space: pre-line !important;display: inline-block;max-width: 100%;overflow-x: auto;overflow-y: hidden;scrollbar-width: thin;overflow-wrap: break-word;word-break: break-word;vertical-align: -7px}.content > p {overflow-wrap: break-word;word-break: break-word}
    </style>
    <style type="text/css">
    	pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}
		.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}
    	pre{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-weight:400;word-break:break-word;word-wrap:break-word;box-sizing:inherit;border-radius:4px;overflow-x:auto;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}code{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;word-wrap:break-word;word-break:break-word;font-style:normal;line-height:20px;letter-spacing:-.003em;box-sizing:inherit;font-weight:400;font-size:75%;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}
    </style>
    <style type="text/css">
    	.back-to-top{position:fixed;bottom:20px;right:20px;background-color:#a73f3f;color:#fff;padding:8px 10px;border-radius:50%;box-shadow:0 4px 6px rgb(0 0 0 / .2);font-size:10px;font-weight:700;text-decoration:none;text-align:center;transition:opacity 0.3s ease,visibility 0.3s ease;z-index:99999;opacity:1;visibility:visible}.back-to-top:hover{background-color:#0056b3}
    </style>
    <style type="text/css">
        .ad-header {margin: 1rem auto 1rem;background-color: #fdfdfd;text-align: center;display: block;}.ad-header .ad-wrapper {min-height: 90px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #555;font-weight: 500;padding: 3rem;border: 1px dashed #ccc;border-radius: 6px;}@media (max-width: 768px) {.ad-header {padding: 0.75rem;}}.ad-sidebar {margin: 0 0 1rem;background-color: #fefefe;text-align: center;padding: 0px;width: 100%;max-width: 100%;display: block;}.ad-sidebar .ad-wrapper {min-height: 250px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #444;font-weight: 500;border: 1px dashed #aaa;border-radius: 6px;padding: 0rem;}@media (max-width: 1024px) {.ad-sidebar {padding: 0.75rem;}}
    </style>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Article",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://catatansoal.github.io/blog/sql-combine-rows-remove-nulls"
          },
          "headline": "SQL: Combine Rows, Remove Nulls &amp; Swap Values",
          "description": "SQL: Combine Rows, Remove Nulls & Swap Values...",
          "image": [
            "https://tse4.mm.bing.net/th?q=Combine%20Rows%20to%20Remove%20Nulls%20or%20Swap%20Values%20in%20SQL%20Server"
          ],
          "author": {
            "@type": "Person",
            "name": "ADMIN",
            "jobTitle": "Editor web"
          },
          "publisher": {
            "@type": "Organization",
            "name": "Question Notes",
            "logo": {
              "@type": "ImageObject",
              "url": "https://tse4.mm.bing.net/th?q=Question%20Notes"
            }
          },
          "datePublished": "2025-08-06T11:52:33+00:00",
          "dateModified": "2025-08-06T11:52:33+00:00"
        }
    </script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container nav-container">
                <div class="nav-left">
                    <span class="logo">Question Notes</span>
                    <span class="blog-tag">Article</span>
                </div>
                <div class="nav-search">
                    <form class="search-form" role="search">
                        <input 
                            type="search" 
                            class="search-input"
                            placeholder="Search articles..."
                            aria-label="Search articles"
                        >
                        <button type="submit" class="search-button" aria-label="Submit search">🔎</button>
                    </form>
                </div>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span class="hamburger"></span>
                </button>
                <div class="nav-menu">
                    <ul class="nav-list">
                    	<li><a href="/" class="nav-link">HOME</a></li>
                        <li><a href="/pages/About" class="nav-link">About</a></li>
                        <li><a href="/pages/Contact" class="nav-link">Contact</a></li>
                        <li><a href="/pages/Disclaimer" class="nav-link">Disclaimer</a></li>
                        <li><a href="/pages/Privacy" class="nav-link">Privacy</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="main">
        <article class="article">
            <header class="article-header">
                <div class="container">
                    <h1>SQL: Combine Rows, Remove Nulls &amp; Swap Values</h1>
                    <div class="meta">
                        <time datetime="2025-08-06T11:52:33+00:00">Aug 6, 2025</time>
                        <span class="author">by ADMIN</span>
                        <span class="view-count">
                            <span id="viewCount">46</span> views
                        </span>
                    </div>
                </div>
            </header>
            <div class="ad-header container">
                <!-- <div class="ad-wrapper">
    Iklan Headers
</div> -->
            </div>
            <div class="container">
                <div class="article-layout">
                    <div class="content">
                        <img src="https://tse4.mm.bing.net/th?q=Combine%20Rows%20to%20Remove%20Nulls%20or%20Swap%20Values%20in%20SQL%20Server" title="Combine Rows to Remove Nulls or Swap Values in SQL Server" width="300" height="200"/><p>Hey guys! Today, we're diving into a common SQL challenge: how to combine rows when dealing with null values or swapping row values if they're not null. This is super useful when you're cleaning data, merging information, or just trying to get a cleaner view of your data. We'll be focusing on SQL Server, but the concepts apply to other SQL databases too.</p>
<h2>Understanding the Problem</h2>
<p>Before we jump into solutions, let's make sure we're all on the same page. Imagine you have a table like this:</p>
<pre><code class="hljs">ID  Account Contact
-----------------------
ID1 A11     C11
ID1 A12     NULL
ID2 A21     NULL
ID2 A22     C22
ID3 A31     C31
ID3 A32     C32
</code></pre>
<p>Our goal is to combine rows with the same <code>ID</code>. If one row has a <code>Contact</code> and the other has a <code>NULL</code>, we want to fill in the <code>NULL</code>. If both rows have a <code>Contact</code>, we might want to choose one or combine them somehow. The desired output would look something like this:</p>
<pre><code class="hljs">ID  Account Contact
-----------------------
ID1 A11     C11
ID1 A12     C11
ID2 A21     C22
ID2 A22     C22
ID3 A31     C31
ID3 A32     C32
</code></pre>
<p>Sounds tricky? Don't worry, we'll break it down step by step.</p>
<h2>Prerequisites</h2>
<p>Before we start, make sure you have:</p>
<ul>
<li>A SQL Server environment (or any SQL database will do, but the syntax might vary slightly).</li>
<li>A table with the structure mentioned above. You can create one using the following script:</li>
</ul>
<pre><code class="hljs">CREATE TABLE YourTable (
    ID VARCHAR(10),
    Account VARCHAR(10),
    Contact VARCHAR(10)
);

INSERT INTO YourTable (ID, Account, Contact) VALUES
(&#39;ID1&#39;, &#39;A11&#39;, &#39;C11&#39;),
(&#39;ID1&#39;, &#39;A12&#39;, NULL),
(&#39;ID2&#39;, &#39;A21&#39;, NULL),
(&#39;ID2&#39;, &#39;A22&#39;, &#39;C22&#39;),
(&#39;ID3&#39;, &#39;A31&#39;, &#39;C31&#39;),
(&#39;ID3&#39;, &#39;A32&#39;, &#39;C32&#39;);
</code></pre>
<h2>Method 1: Using <code>ROW_NUMBER()</code> and <code>CASE</code> Statements</h2>
<h3>Understanding <code>ROW_NUMBER()</code></h3>
<p>The <code>ROW_NUMBER()</code> function is a window function that assigns a unique sequential integer to each row within a partition of a result set. We'll use it to identify the first row for each <code>ID</code>.</p>
<h3>Implementing the Solution</h3>
<p>The <strong>first step</strong> in solving this problem is to understand the data structure and the desired outcome. We have a table with <code>ID</code>, <code>Account</code>, and <code>Contact</code> columns, and the goal is to populate the <code>Contact</code> column for rows where it is <code>NULL</code>, using the non-<code>NULL</code> value from other rows with the same <code>ID</code>. This requires us to group the rows by <code>ID</code> and then apply some logic to fill in the missing <code>Contact</code> values.</p>
<p>The <strong>next critical step</strong> is to use <code>ROW_NUMBER()</code> to assign a unique rank to each row within each <code>ID</code> group. This will help us identify the first row (which ideally contains the non-<code>NULL</code> <code>Contact</code> value) and use it to update other rows within the same group. The <code>PARTITION BY ID</code> clause is essential here as it ensures that row numbering is done separately for each unique <code>ID</code>.</p>
<pre><code class="hljs">WITH RankedData AS (
    SELECT
        ID,
        Account,
        Contact,
        ROW_NUMBER() OVER (PARTITION BY ID ORDER BY (CASE WHEN Contact IS NOT NULL THEN 0 ELSE 1 END)) AS rn
    FROM
        YourTable
)
SELECT
    ID,
    Account,
    COALESCE(Contact, (SELECT Contact FROM RankedData rd2 WHERE rd2.ID = rd1.ID AND rd2.rn = 1)) AS Contact
FROM
    RankedData rd1;
</code></pre>
<p>In this query:</p>
<ol>
<li>We use a Common Table Expression (CTE) called <code>RankedData</code>.</li>
<li>Inside the CTE, we use <code>ROW_NUMBER()</code> to assign a rank based on whether the <code>Contact</code> is <code>NULL</code> or not. Rows with non-<code>NULL</code> contacts get a lower rank.</li>
<li>In the outer query, we use <code>COALESCE()</code> to fill <code>NULL</code> <code>Contact</code> values with the <code>Contact</code> from the first row (where <code>rn = 1</code>) within the same <code>ID</code> group.</li>
</ol>
<h3>Explanation of the Code</h3>
<p>Let's break down this code a bit more:</p>
<ul>
<li><strong><code>WITH RankedData AS (...)</code></strong>: This is a CTE, which is like a temporary table that exists only for the duration of the query. It helps us organize the logic.</li>
<li><strong><code>ROW_NUMBER() OVER (PARTITION BY ID ORDER BY (CASE WHEN Contact IS NOT NULL THEN 0 ELSE 1 END)) AS rn</code></strong>: This is the heart of the solution. Let's dissect it:
<ul>
<li><code>ROW_NUMBER() OVER (...)</code>: This is the window function that assigns a unique number to each row within a partition.</li>
<li><code>PARTITION BY ID</code>: This divides the data into partitions based on the <code>ID</code> column. So, the numbering restarts for each unique <code>ID</code>.</li>
<li><code>ORDER BY (CASE WHEN Contact IS NOT NULL THEN 0 ELSE 1 END)</code>: This determines the order in which the rows are numbered within each partition. We're using a <code>CASE</code> statement to prioritize rows with non-<code>NULL</code> <code>Contact</code> values. If <code>Contact</code> is not <code>NULL</code>, it gets a 0, otherwise, it gets a 1. This ensures that rows with <code>Contact</code> values get a lower rank (closer to 1).</li>
<li><code>AS rn</code>: This gives the resulting row number column the alias <code>rn</code>.</li>
</ul>
</li>
<li><strong><code>COALESCE(Contact, (SELECT Contact FROM RankedData rd2 WHERE rd2.ID = rd1.ID AND rd2.rn = 1)) AS Contact</code></strong>: This is where we fill in the <code>NULL</code> values. <code>COALESCE()</code> returns the first non-<code>NULL</code> expression in a list. In this case:
<ul>
<li>If <code>Contact</code> is not <code>NULL</code>, it's returned as is.</li>
<li>If <code>Contact</code> is <code>NULL</code>, the subquery is executed.</li>
<li>The subquery <code>(SELECT Contact FROM RankedData rd2 WHERE rd2.ID = rd1.ID AND rd2.rn = 1)</code> selects the <code>Contact</code> value from the first row (where <code>rn = 1</code>) within the same <code>ID</code> group.</li>
</ul>
</li>
</ul>
<p>The <strong>most crucial part</strong> of this solution is the outer <code>SELECT</code> statement where we use <code>COALESCE</code>. <code>COALESCE</code> is a SQL function that returns the first non-NULL expression in a list. In our case, it checks the <code>Contact</code> value of the current row. If it's not <code>NULL</code>, it returns that value. If it is <code>NULL</code>, it triggers the subquery. This subquery is designed to fetch the <code>Contact</code> value from the first row within the same <code>ID</code> group (the row with <code>rn = 1</code>).</p>
<p>This subquery filters the <code>RankedData</code> CTE based on two conditions: <code>rd2.ID = rd1.ID</code> ensures that we are looking within the same <code>ID</code> group, and <code>rd2.rn = 1</code> ensures that we are selecting the first row, which, thanks to our <code>ORDER BY</code> clause in <code>ROW_NUMBER()</code>, is the row with the non-<code>NULL</code> <code>Contact</code> value (if it exists). By using <code>COALESCE</code> in this way, we effectively fill in the missing <code>Contact</code> values with the corresponding non-<code>NULL</code> values from other rows with the same <code>ID</code>.</p>
<h3>Benefits of this Method</h3>
<ul>
<li><strong>Handles NULLs</strong>: This method effectively fills in <code>NULL</code> values.</li>
<li><strong>Prioritizes Existing Values</strong>: It uses existing non-<code>NULL</code> values where available.</li>
</ul>
<h3>Potential Drawbacks</h3>
<ul>
<li><strong>Performance</strong>: For very large tables, the subquery in <code>COALESCE()</code> might impact performance. We'll look at alternatives later.</li>
<li><strong>Complexity</strong>: The query can be a bit harder to read and understand compared to simpler methods.</li>
</ul>
<h2>Method 2: Using <code>MAX()</code> with Grouping</h2>
<h3>Understanding <code>MAX()</code> with Grouping</h3>
<p>The <strong>alternative approach</strong> involves using the <code>MAX()</code> aggregate function in conjunction with a <code>GROUP BY</code> clause. This method is generally simpler and more efficient, especially for large datasets. The basic idea is to group the rows by <code>ID</code> and then use <code>MAX(Contact)</code> to select the non-<code>NULL</code> <code>Contact</code> value within each group. Since <code>MAX()</code> ignores <code>NULL</code> values, it will automatically pick the non-<code>NULL</code> <code>Contact</code> if one exists.</p>
<h3>Implementing the Solution</h3>
<p>This method leverages the <code>MAX()</code> aggregate function and grouping to achieve the same result. It's often more efficient and easier to read.</p>
<pre><code class="hljs">SELECT
    ID,
    Account,
    MAX(Contact) AS Contact
FROM
    YourTable
GROUP BY
    ID, Account;
</code></pre>
<h3>Explanation of the Code</h3>
<ul>
<li><strong><code>SELECT ID, Account, MAX(Contact) AS Contact</code></strong>: This selects the <code>ID</code>, <code>Account</code>, and the maximum <code>Contact</code> value for each group.</li>
<li><strong><code>FROM YourTable</code></strong>: This specifies the table we're querying.</li>
<li><strong><code>GROUP BY ID, Account</code></strong>: This groups the rows by <code>ID</code> and <code>Account</code>. The <code>MAX()</code> function is applied within each group.</li>
</ul>
<p>The <strong>core of this method</strong> is the <code>MAX(Contact)</code> aggregate function. When used in conjunction with <code>GROUP BY</code>, <code>MAX()</code> returns the maximum value within each group. The critical advantage here is that <code>MAX()</code> inherently ignores <code>NULL</code> values. This means that if a group contains both <code>NULL</code> and non-<code>NULL</code> <code>Contact</code> values, <code>MAX()</code> will automatically select the non-<code>NULL</code> value. This makes the query very concise and efficient for our use case.</p>
<p>By grouping the data by <code>ID</code> and <code>Account</code>, we ensure that the <code>MAX(Contact)</code> function is applied to rows with the same <code>ID</code>. This effectively fills in the missing <code>Contact</code> values with the corresponding non-<code>NULL</code> values from other rows with the same <code>ID</code>, achieving the desired result in a straightforward manner.</p>
<h3>How it Works</h3>
<p><code>MAX()</code> ignores <code>NULL</code> values. So, when we group by <code>ID</code> and <code>Account</code>, the <code>MAX(Contact)</code> will return the non-<code>NULL</code> <code>Contact</code> value if there is one, otherwise, it will return <code>NULL</code>.</p>
<h3>Benefits of this Method</h3>
<ul>
<li><strong>Simplicity</strong>: It's much easier to read and understand.</li>
<li><strong>Performance</strong>: It's generally faster than the <code>ROW_NUMBER()</code> method, especially for large tables.</li>
</ul>
<h3>Potential Drawbacks</h3>
<ul>
<li><strong>Account Column</strong>: This method includes the <code>Account</code> column in the <code>GROUP BY</code> clause. If you only want to combine based on <code>ID</code>, you might need to adjust the query or use a subquery.</li>
<li><strong>Not Suitable for Complex Logic</strong>: If you need more complex logic for combining values (e.g., choosing between two non-<code>NULL</code> contacts based on some criteria), this method might not be flexible enough.</li>
</ul>
<h2>Method 3: Using <code>OUTER APPLY</code> (SQL Server Specific)</h2>
<h3>Understanding <code>OUTER APPLY</code></h3>
<p><code>OUTER APPLY</code> is a powerful feature in SQL Server that allows you to invoke a table-valued function (or a subquery that returns a table) for each row of an outer table expression. It's like a more flexible version of a <code>JOIN</code>. We can use it to select the non-<code>NULL</code> <code>Contact</code> for each <code>ID</code>.</p>
<h3>Implementing the Solution</h3>
<p>This method utilizes <code>OUTER APPLY</code>, which is a SQL Server-specific feature that can be very powerful for these kinds of operations. <code>OUTER APPLY</code> allows you to execute a subquery for each row in the outer table, which makes it ideal for finding related data within groups.</p>
<pre><code class="hljs">SELECT
    yt.ID,
    yt.Account,
    COALESCE(yt.Contact, sub.Contact) AS Contact
FROM
    YourTable yt
    OUTER APPLY (
        SELECT TOP 1 Contact
        FROM YourTable
        WHERE ID = yt.ID
        AND Contact IS NOT NULL
        ORDER BY Contact
    ) AS sub;
</code></pre>
<h3>Explanation of the Code</h3>
<ul>
<li><strong><code>SELECT yt.ID, yt.Account, COALESCE(yt.Contact, sub.Contact) AS Contact</code></strong>: This selects the <code>ID</code>, <code>Account</code>, and the combined <code>Contact</code> value.</li>
<li><strong><code>FROM YourTable yt OUTER APPLY (...) AS sub</code></strong>: This is the <code>OUTER APPLY</code> clause. It executes the subquery for each row in <code>YourTable</code>.</li>
<li><strong><code>SELECT TOP 1 Contact FROM YourTable WHERE ID = yt.ID AND Contact IS NOT NULL ORDER BY Contact</code></strong>: This is the subquery. It selects the first non-<code>NULL</code> <code>Contact</code> value for the current <code>ID</code>. <code>TOP 1</code> ensures we only get one result.</li>
<li><strong><code>COALESCE(yt.Contact, sub.Contact)</code></strong>: This fills in <code>NULL</code> <code>Contact</code> values with the result from the subquery.</li>
</ul>
<p>Let's break down <strong>the most critical part</strong>, the <code>OUTER APPLY</code> clause and its subquery. The <code>OUTER APPLY</code> essentially says,</p>

                    </div>
                    <aside class="related-posts">
                        <div class="ad-sidebar container">
                            <!-- <div class="ad-wrapper">
    <span>Iklan Related</span>
</div> -->
                        </div>
                        <h2 class="related-posts-title">Related Posts</h2><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/calculating-catch-up-time-a">Calculating Catch-Up Time A Comprehensive Guide</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-13T23:07:26+00:00">Jul 13, 2025</time>
		                        <span class="view-count">
									47 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/minitalk-a-comprehensive-guide-to">Minitalk A Comprehensive Guide To Mastering Inter-Process Communication</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-26T02:38:20+00:00">Jul 26, 2025</time>
		                        <span class="view-count">
									71 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/understanding-limits-in-derivative-calculations">Understanding Limits In Derivative Calculations The Real Meaning</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-16T21:08:14+00:00">Jul 16, 2025</time>
		                        <span class="view-count">
									64 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/stop-husbands-verbal-abuse-a">Stop Husband&#39;s Verbal Abuse: A Guide For Wives</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-10T02:21:34+00:00">Aug 10, 2025</time>
		                        <span class="view-count">
									46 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/im-injection-your-comprehensive-guide">IM Injection: Your Comprehensive Guide To Intramuscular Injections</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-03T05:57:10+00:00">Aug 3, 2025</time>
		                        <span class="view-count">
									66 views
		                        </span>
                            </div>
                        </article>
                    </aside>
                    <aside class="related-posts"></aside>
                </div>
            </div>
        </article>
        <a href="#" class="back-to-top" id="backToTop" title="Back to top">
        	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-up" viewBox="0 0 16 16">
			  <path fill-rule="evenodd" d="M3.646 11.854a.5.5 0 0 0 .708 0L8 8.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708M2.4 5.2c0 .22.18.4.4.4h10.4a.4.4 0 0 0 0-.8H2.8a.4.4 0 0 0-.4.4"/>
			</svg>
		</a>
    </main>
    <footer class="footer">
        <div class="container">
            <p>© 2025 Question Notes</p>
        </div>
    </footer>
    <script>
    	(() => {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            const toggleMenu = () => {
                navMenu.classList.toggle('nav-menu-active');
                navToggle.classList.toggle('nav-toggle-active');
            };
            const backToTopHandler = (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            navToggle.addEventListener('click', toggleMenu);
            document.getElementById('backToTop').addEventListener('click', backToTopHandler);
            window.addEventListener('pagehide', () => {
                navToggle.removeEventListener('click', toggleMenu);
                document.getElementById('backToTop').removeEventListener('click', backToTopHandler);
            });
        })();
		(() => {
            window.addEventListener("DOMContentLoaded", (event) => {
                const ellHljs = document.createElement("script");
                ellHljs.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js");
                ellHljs.onload = () => {
                    hljs.highlightAll();
                };
                document.querySelector("body").append(ellHljs);
                const ellFont = document.createElement("link");
                ellFont.setAttribute("href", "https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css");
                ellFont.setAttribute("rel", "stylesheet");
                document.querySelector("head").append(ellFont);
                window.addEventListener('pagehide', () => {
                    // ellHljs.remove();
                    ellFont.remove();
                });

            });
        })();
    </script>
    <!-- Histats.com  START  (aync)-->
<script type="text/javascript">var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4957095,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
(function() {
var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
hs.src = ('//s10.histats.com/js15_as.js');
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();</script>
<!-- Histats.com  END  -->
    
    
</body>
</html>