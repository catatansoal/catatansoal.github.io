<!DOCTYPE html>
<html lang="en">
<head>
	<title>Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive...">
    <link rel="canonical" href="https://catatansoal.github.io/blog/fixing-systemd-oomd-crashes-with">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive">
	<meta property="og:description" content="Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive...">
	<meta property="og:url" content="https://catatansoal.github.io/blog/fixing-systemd-oomd-crashes-with">
	<meta property="og:site_name" content="Question Notes">
	<meta property="article:published_time" content="2025-08-11T01:50:22+00:00">
	<meta property="article:author" content="ADMIN">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js">
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <link rel="preload" fetchpriority="high" as="image" href="https://tse4.mm.bing.net/th?q=Troubleshooting%20systemd-oomd%20Crashes%20with%20Sanitizers">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style type="text/css">
    	:root{--primary-color:#3740ff;--text-color:#202124;--background-color:#ffffff;--gray-100:#f8f9fa;--gray-200:#e9ecef}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.6;color:var(--text-color);background-color:var(--background-color)}.container{max-width:1200px;margin:0 auto;padding:0 1.5rem}.header{background-color:var(--background-color);border-bottom:1px solid var(--gray-200);position:sticky;top:0;z-index:100}.nav{padding:.5rem 0}.nav-container{display:flex;justify-content:space-between;align-items:center;gap:1rem}.nav-left{display:flex;align-items:center;flex-shrink:0}.logo{font-weight:700;color:var(--primary-color)}.blog-tag{margin-left:1rem;padding:.25rem .5rem;background-color:var(--gray-100);border-radius:4px;font-size:.875rem}.nav-search{flex-grow:1;max-width:300px}.search-form{position:relative;width:100%}.search-input{width:100%;padding:.5rem 2.5rem .5rem 1rem;border:1px solid var(--gray-200);border-radius:24px;font-size:.875rem;transition:all 0.2s}.search-input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgb(55 64 255 / .1)}.search-button{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#5f6368;cursor:pointer;padding:.25rem;display:flex;align-items:center;justify-content:center}.search-button:hover{color:var(--primary-color)}.nav-toggle{display:none;background:none;border:none;cursor:pointer;padding:.5rem}.hamburger{display:block;position:relative;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before,.hamburger::after{content:'';position:absolute;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before{top:-6px}.hamburger::after{bottom:-6px}.nav-toggle-active .hamburger{background:#fff0}.nav-toggle-active .hamburger::before{transform:rotate(45deg);top:0}.nav-toggle-active .hamburger::after{transform:rotate(-45deg);bottom:0}.nav-list{display:flex;list-style:none;gap:2rem}.nav-link{color:var(--text-color);text-decoration:none;font-size:.9rem;transition:color 0.2s}.nav-link:hover{color:var(--primary-color)}.article-header{padding:2rem 0;background-color:var(--gray-100)}.article-layout{display:grid;grid-template-columns:1fr 350px;gap:3rem;padding:1rem 0;align-items: start}h1,h2,h3,h4,h5,h6{font-family:"Crimson Text","Times New Roman",Times,serif}h1{font-size:2.5rem;line-height:1.2;margin-bottom:1rem}.meta{color:#5f6368;font-size:.875rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.view-count{display:inline-flex;align-items:center;gap:.25rem}.view-count svg{color:#5f6368}.content{min-width:0;border-bottom:1px solid #dddddd5e;margin-top:1rem;white-space:pre-line !important;overflow-wrap:break-word;overflow-x:auto;word-break:break-word}.lead{font-size:1.25rem;color:#5f6368;margin-bottom:2rem}h2,h3,h4,h5,h6{font-size:1.75rem;margin:1rem 0 1rem}p,pre,ol,ul>li{margin-bottom:1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;font-size:1.3rem;text-align: justify;}p>code{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px}hr{margin:1rem 0 1rem 0}.code-example{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;margin:1.5rem 0;overflow-x:auto}code{font-family:'Roboto Mono',monospace;font-size:.875rem}ul{margin:.2rem 0;padding-left:1.5rem}.related-posts{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;position:sticky;top:5rem}.related-posts-title,.newpost-posts-list{font-size:1.75rem;margin:0 0 1rem}.related-posts-list{display:flex;flex-direction:column;gap:.5rem}.related-post,.newpost-post{border-bottom:1px solid #ddd;padding-bottom:10px;margin-bottom:10px}.related-post:last-child,.newpost-post:last-child{padding-bottom:0;border-bottom:none}.related-post-title,.newpost-post-title{font-size:1.2rem;margin:0 0 .1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;}.related-post-title a,.newpost-post-title a{color:var(--text-color);text-decoration:none;transition:color 0.2s}.related-post-title a:hover,.newpost-post-title a:hover{color:var(--primary-color)}.related-post time{font-size:.875rem;color:#5f6368}.footer{background-color:var(--gray-100);padding:2rem 0;margin-top:4rem;color:#5f6368;font-size:.875rem}.nav-menu>ul>li{margin-bottom:0}@media (max-width:1024px){.container{max-width:800px}.article-layout{grid-template-columns:1fr;gap:2rem}.related-posts{position:static}}@media (max-width:768px){.nav-container{flex-wrap:wrap}.nav-search{order:3;max-width:none;width:100%;margin-top:.1rem}.nav-toggle{display:block}.nav-menu{display:none;position:absolute;top:100%;left:0;right:0;background:var(--background-color);padding:1rem 0;border-bottom:1px solid var(--gray-200)}.nav-menu-active{display:block}.nav-list{flex-direction:column;gap:.1rem;padding:0 1.5rem}.nav-link{display:block;padding:.2rem 0}h1{font-size:2rem}.article-header{padding:2rem 0}.content{padding:.1rem 0}}table{width:100%;border-collapse:collapse;margin:20px 0;font-family:'Arial',sans-serif}th,td{padding:12px 15px;text-align:left;border:1px solid #ddd}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9}tr:nth-child(even) td{background-color:#f2f2f2}@media screen and (max-width:768px){table{border:0;display:block;overflow-x:auto;white-space:nowrap}th,td{padding:10px;text-align:right}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9;border-bottom:1px solid #ddd}tr:nth-child(even) td{background-color:#f2f2f2}}a{text-decoration:none;color:#540707}.katex-html{padding: .2rem;color: #000;font-weight: 700;font-size: 1.3rem;overflow-wrap: break-word;max-width: 100%;white-space: normal !important}.category{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;margin:1rem 0 1rem 0}.tag{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px;font-family:"Newsreader",serif}.tag>a{text-decoration:none;color:#000}img{margin:auto;display:block;max-width:100%;height:auto;margin-bottom:1rem}.katex{white-space: pre-line !important;display: inline-block;max-width: 100%;overflow-x: auto;overflow-y: hidden;scrollbar-width: thin;overflow-wrap: break-word;word-break: break-word;vertical-align: -7px}.content > p {overflow-wrap: break-word;word-break: break-word}
    </style>
    <style type="text/css">
    	pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}
		.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}
    	pre{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-weight:400;word-break:break-word;word-wrap:break-word;box-sizing:inherit;border-radius:4px;overflow-x:auto;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}code{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;word-wrap:break-word;word-break:break-word;font-style:normal;line-height:20px;letter-spacing:-.003em;box-sizing:inherit;font-weight:400;font-size:75%;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}
    </style>
    <style type="text/css">
    	.back-to-top{position:fixed;bottom:20px;right:20px;background-color:#a73f3f;color:#fff;padding:8px 10px;border-radius:50%;box-shadow:0 4px 6px rgb(0 0 0 / .2);font-size:10px;font-weight:700;text-decoration:none;text-align:center;transition:opacity 0.3s ease,visibility 0.3s ease;z-index:99999;opacity:1;visibility:visible}.back-to-top:hover{background-color:#0056b3}
    </style>
    <style type="text/css">
        .ad-header {margin: 1rem auto 1rem;background-color: #fdfdfd;text-align: center;display: block;}.ad-header .ad-wrapper {min-height: 90px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #555;font-weight: 500;padding: 3rem;border: 1px dashed #ccc;border-radius: 6px;}@media (max-width: 768px) {.ad-header {padding: 0.75rem;}}.ad-sidebar {margin: 0 0 1rem;background-color: #fefefe;text-align: center;padding: 0px;width: 100%;max-width: 100%;display: block;}.ad-sidebar .ad-wrapper {min-height: 250px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #444;font-weight: 500;border: 1px dashed #aaa;border-radius: 6px;padding: 0rem;}@media (max-width: 1024px) {.ad-sidebar {padding: 0.75rem;}}
    </style>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Article",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://catatansoal.github.io/blog/fixing-systemd-oomd-crashes-with"
          },
          "headline": "Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive",
          "description": "Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive...",
          "image": [
            "https://tse4.mm.bing.net/th?q=Troubleshooting%20systemd-oomd%20Crashes%20with%20Sanitizers"
          ],
          "author": {
            "@type": "Person",
            "name": "ADMIN",
            "jobTitle": "Editor web"
          },
          "publisher": {
            "@type": "Organization",
            "name": "Question Notes",
            "logo": {
              "@type": "ImageObject",
              "url": "https://tse4.mm.bing.net/th?q=Question%20Notes"
            }
          },
          "datePublished": "2025-08-11T01:50:22+00:00",
          "dateModified": "2025-08-11T01:50:22+00:00"
        }
    </script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container nav-container">
                <div class="nav-left">
                    <span class="logo">Question Notes</span>
                    <span class="blog-tag">Article</span>
                </div>
                <div class="nav-search">
                    <form class="search-form" role="search">
                        <input 
                            type="search" 
                            class="search-input"
                            placeholder="Search articles..."
                            aria-label="Search articles"
                        >
                        <button type="submit" class="search-button" aria-label="Submit search">🔎</button>
                    </form>
                </div>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span class="hamburger"></span>
                </button>
                <div class="nav-menu">
                    <ul class="nav-list">
                    	<li><a href="/" class="nav-link">HOME</a></li>
                        <li><a href="/pages/About" class="nav-link">About</a></li>
                        <li><a href="/pages/Contact" class="nav-link">Contact</a></li>
                        <li><a href="/pages/Disclaimer" class="nav-link">Disclaimer</a></li>
                        <li><a href="/pages/Privacy" class="nav-link">Privacy</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="main">
        <article class="article">
            <header class="article-header">
                <div class="container">
                    <h1>Fixing Systemd-oomd Crashes With Sanitizers: A Deep Dive</h1>
                    <div class="meta">
                        <time datetime="2025-08-11T01:50:22+00:00">Aug 11, 2025</time>
                        <span class="author">by ADMIN</span>
                        <span class="view-count">
                            <span id="viewCount">57</span> views
                        </span>
                    </div>
                </div>
            </header>
            <div class="ad-header container">
                <!-- <div class="ad-wrapper">
    Iklan Headers
</div> -->
            </div>
            <div class="container">
                <div class="article-layout">
                    <div class="content">
                        <img src="https://tse4.mm.bing.net/th?q=Troubleshooting%20systemd-oomd%20Crashes%20with%20Sanitizers" title="Troubleshooting systemd-oomd Crashes with Sanitizers" width="300" height="200"/><p>It appears we've encountered a frustrating issue with <code>systemd-oomd</code> crashing when running with sanitizers. Specifically, the logs indicate an <strong>ABRT signal (Signal 6)</strong>, meaning the program terminated abnormally. This often points to memory corruption or other serious errors detected by the sanitizer. Let's dive into the details and figure out how to troubleshoot this.</p>
<h2>Understanding the Problem</h2>
<p>From the provided information, we can see that <code>systemd-oomd</code> (PID 77) crashed on August 10, 2025. The core dump and stack trace are invaluable clues here. The stack trace points to a series of function calls within the AddressSanitizer (<code>libclang_rt.asan.so</code>) and LeakSanitizer (<code>libclang_rt.lsan.so</code>), suggesting that a memory-related issue was detected during the program's execution.</p>
<p>Here's a breakdown of the key information:</p>
<ul>
<li><strong>Process:</strong> <code>systemd-oomd</code></li>
<li><strong>Signal:</strong> 6 (ABRT)</li>
<li><strong>Timestamp:</strong> Sun 2025-08-10 16:16:34 UTC</li>
<li><strong>Executable:</strong> <code>/usr/lib/systemd/systemd-oomd</code></li>
<li><strong>Stack Trace:</strong> Shows calls within <code>libclang_rt.asan.so</code> and <code>libclang_rt.lsan.so</code></li>
</ul>
<p>The stack trace is crucial because it gives us a glimpse into the sequence of function calls that led to the crash. We see functions like <code>__sanitizer12StopTheWorld</code>, <code>LockStuffAndStopTheWorldCallback</code>, and <code>CheckForLeaks</code>, which are all part of the sanitizers' error detection mechanisms. These functions are invoked when the sanitizer detects a potential memory error, such as a memory leak, use-after-free, or heap-buffer-overflow.</p>
<p>It's also worth noting the list of modules loaded by <code>systemd-oomd</code>, including libraries like <code>libpcre2-8.so.0</code>, <code>libeconf.so.0</code>, and <code>libc.so.6</code>. These are standard system libraries, so the issue is less likely to be within these core components and more likely within <code>systemd-oomd</code> itself or its direct dependencies.</p>
<h3>Deep Dive into Sanitizers</h3>
<p><strong>Sanitizers</strong> are powerful debugging tools that help detect memory corruption and other runtime errors in C/C++ programs. They work by instrumenting the code at compile time and adding checks to memory accesses, allocations, and deallocations. When a sanitizer detects an error, it typically halts the program and provides detailed diagnostic information, such as a stack trace and the type of error encountered.</p>
<ul>
<li><strong>AddressSanitizer (ASan):</strong> Detects memory errors like heap-buffer-overflows, stack-buffer-overflows, use-after-free, and use-after-return.</li>
<li><strong>LeakSanitizer (LSan):</strong> Detects memory leaks by tracking allocated memory and identifying blocks that are no longer reachable by the program.</li>
<li><strong>UndefinedBehaviorSanitizer (UBSan):</strong> Detects undefined behavior, such as integer overflows, division by zero, and accessing a variable with an uninitialized value.</li>
</ul>
<p>In this case, the presence of <code>libclang_rt.asan.so</code> and the <code>CheckForLeaks</code> function in the stack trace indicates that both ASan and LSan are involved, suggesting a potential combination of memory safety and memory leak issues.</p>
<h2>Steps to Troubleshoot the Failure</h2>
<p>Okay, so now we know what's going on in general. Let's get into the nitty-gritty of troubleshooting. Here's a breakdown of the steps we can take to diagnose and fix this <code>systemd-oomd</code> crash:</p>
<h3>1. Re-run with Debugging Symbols</h3>
<p>First things first, guys, we need more information! The stack trace we have is helpful, but it only shows addresses. To make sense of it, we need debugging symbols. These symbols map memory addresses to function names, line numbers, and variable names in the source code. This will make the stack trace much easier to understand. To make sure that you have debugging symbols installed, use the following command:</p>
<pre><code class="hljs">debuginfo-install systemd
</code></pre>
<p>This command installs the debugging symbols for the <code>systemd</code> package, which includes <code>systemd-oomd</code>. After installing the debugging symbols, re-running the test or the scenario that triggers the crash will generate a more informative stack trace.</p>
<h3>2. Analyze the Stack Trace</h3>
<p>Once you have a stack trace with symbols, carefully examine it. Start from the top (the point where the crash occurred) and work your way down the call stack. Look for function names that you recognize from the <code>systemd-oomd</code> source code. Pay close attention to any functions that involve memory allocation, deallocation, or manipulation.</p>
<ul>
<li><strong>Identify the root cause:</strong> The goal here is to pinpoint the exact line of code that is causing the issue. Look for patterns in the stack trace. Are there any particular functions or code paths that seem to be consistently involved in crashes?</li>
<li><strong>Look for memory-related operations:</strong> Functions like <code>malloc</code>, <code>free</code>, <code>calloc</code>, <code>realloc</code>, and any custom memory management routines are prime suspects. Check if memory is being allocated but not freed, freed multiple times, or accessed after being freed.</li>
<li><strong>Consider concurrency issues:</strong> If <code>systemd-oomd</code> uses multiple threads, the crash could be due to a race condition or other concurrency-related bug. Look for locks, mutexes, and other synchronization primitives in the code.</li>
</ul>
<h3>3. Review the Source Code</h3>
<p>With a better understanding of the stack trace, it's time to dive into the source code. Focus on the functions and code paths identified in the stack trace. Look for potential memory errors, such as:</p>
<ul>
<li><strong>Buffer overflows:</strong> Writing beyond the bounds of an allocated buffer.</li>
<li><strong>Use-after-free:</strong> Accessing memory that has already been freed.</li>
<li><strong>Memory leaks:</strong> Allocating memory but never freeing it.</li>
<li><strong>Double frees:</strong> Freeing the same memory twice.</li>
<li><strong>Invalid memory access:</strong> Accessing memory that is not owned by the program.</li>
</ul>
<h3>4. Reproduce the Issue</h3>
<p>A key step in troubleshooting is being able to reliably reproduce the crash. If you can reproduce the issue consistently, it will be much easier to test potential fixes. Try to isolate the specific conditions that trigger the crash. This might involve running <code>systemd-oomd</code> with a particular configuration, under a specific workload, or with certain system settings.</p>
<p>If the issue is difficult to reproduce, consider using techniques like fuzzing to generate a wide range of inputs and increase the chances of triggering the bug. <em>Fuzzing</em> is a testing technique that involves feeding a program with random or malformed input data to uncover vulnerabilities and crashes.</p>
<h3>5. Test with Different Sanitizer Options</h3>
<p>Sanitizers often have various options that can be used to customize their behavior and reporting. Experimenting with these options can sometimes provide more detailed information about the crash. For example, ASan has options to control the level of memory poisoning, the handling of stack frames, and the reporting of errors.</p>
<h3>6. Check for Known Issues and Updates</h3>
<p>Before spending too much time debugging, it's always a good idea to check if the issue is already known or has been fixed in a newer version of <code>systemd</code>. Search the <code>systemd</code> issue tracker (e.g., on GitHub) and mailing lists for similar reports. If a fix is available, updating to the latest version might resolve the problem.</p>
<h3>7. Consider the Environment</h3>
<p>Sometimes, the environment in which <code>systemd-oomd</code> is running can influence its behavior. Factors such as the kernel version, the C library version, and the presence of other libraries can all play a role. If possible, try reproducing the issue in a different environment to see if it persists.</p>
<h3>Example Scenario: Use-After-Free</h3>
<p>Let's imagine a scenario where the stack trace points to a function that's handling a list of processes. The crash occurs when the code tries to access a process object after it has been removed from the list and freed from memory. This is a classic use-after-free vulnerability.</p>
<p>In this case, you'd want to carefully review the code that manages the process list. Look for potential race conditions where a process object might be accessed by one thread while another thread is removing it from the list and freeing its memory. You might also need to examine the code that frees process objects to ensure that they are not being freed prematurely.</p>
<h2>Analyzing the Provided Stack Trace in Detail</h2>
<p>Let's revisit the provided stack trace and see if we can glean any more insights:</p>
<pre><code class="hljs">Stack trace of thread 77:
#0  0x00007f6330eea60b __sched_yield (libc.so.6 + 0xdb60b)
#1  0x00007f633221ea65 _ZN11__sanitizer12StopTheWorldEPFvRKNS_20SuspendedThreadsListEPvES3_ (libclang_rt.asan.so + 0x1ea65)
#2  0x00007f633223207e _ZN6__lsanL32LockStuffAndStopTheWorldCallbackEP12dl_phdr_infomPv (libclang_rt.asan.so + 0x3207e)
#3  0x00007f6330f50987 dl_iterate_phdr (libc.so.6 + 0x141987)
#4  0x00007f6332232053 _ZN6__lsan24LockStuffAndStopTheWorldEPFvRKN11__sanitizer20SuspendedThreadsListEPvEPNS_18CheckForLeaksParamE (libclang_rt.asan.so + 0x32053)
#5  0x00007f633222ce2e _ZN6__lsanL13CheckForLeaksEv (libclang_rt.asan.so + 0x2ce2e)
#6  0x00007f633222cb7b _ZN6__lsan11DoLeakCheckEv (libclang_rt.asan.so + 0x2cb7b)
#7  0x00007f6330e2ad00 __cxa_finalize (libc.so.6 + 0x1bd00)
#8  0x00007f6332205367 __do_global_dtors_aux (libclang_rt.asan.so + 0x5367)
#9  0x00007f6332ee82d2 _dl_call_fini (ld-linux-x86-64.so.2 + 0x12d2)
#10 0x00007f6332eec232 _dl_fini (ld-linux-x86-64.so.2 + 0x5232)
#11 0x00007f6330e2b271 __run_exit_handlers (libc.so.6 + 0x1c271)
#12 0x00007f6330e2b34e exit (libc.so.6 + 0x1c34e)
#13 0x00007f6330e1257c __libc_start_call_main (libc.so.6 + 0x357c)
#14 0x00007f6330e12628 __libc_start_main@@GLIBC_2.34 (libc.so.6 + 0x3628)
#15 0x0000556f86fc5f85 n/a (/usr/lib/systemd/systemd-oomd (deleted) + 0xcf85)
</code></pre>
<p>The stack trace shows a sequence of events related to program termination and sanitizer checks:</p>
<ol>
<li>The crash ultimately originates from the LeakSanitizer (<code>__lsan</code>) during a leak check (<code>DoLeakCheckEv</code>).</li>
<li>This leak check involves stopping the world (<code>StopTheWorld</code>) to ensure consistent memory state, which is a common practice in sanitizers to avoid race conditions during memory analysis.</li>
<li>The <code>dl_iterate_phdr</code> function suggests that the LeakSanitizer is iterating through the program headers, likely to inspect memory mappings.</li>
<li>The <code>__cxa_finalize</code> function is part of the C++ runtime and is responsible for calling destructors of global objects during program termination.</li>
<li>The functions <code>_dl_call_fini</code> and <code>_dl_fini</code> are part of the dynamic linker and are involved in unloading shared libraries.</li>
<li>The <code>exit</code> function is the standard C library function for terminating a program.</li>
</ol>
<p>Given this stack trace, the issue appears to be triggered during program shutdown, specifically during the LeakSanitizer's leak detection phase. This could indicate a memory leak where allocated memory is not being properly freed before the program exits. It could also be a more complex issue where objects are being destructed in the wrong order, leading to a use-after-free or double-free condition during shutdown.</p>
<h2>Next Steps</h2>
<p>Based on this analysis, here are some specific steps to take:</p>
<ol>
<li><strong>Inspect shutdown code:</strong> Focus on the code in <code>systemd-oomd</code> that handles program shutdown. Look for any memory management operations that might be causing issues during this phase.</li>
<li><strong>Check global object destructors:</strong> If <code>systemd-oomd</code> is written in C++, examine the destructors of global objects. Ensure that they are not accessing memory that has already been freed or relying on other global objects that have already been destructed.</li>
<li><strong>Run with LSan-specific options:</strong> LeakSanitizer has options to control its behavior during shutdown. Experiment with these options to see if you can get more detailed information about the leak or error.</li>
<li><strong>Simplify the test case:</strong> Try to create a minimal test case that reproduces the crash. This will make it easier to debug the issue in isolation.</li>
</ol>
<h2>Conclusion</h2>
<p>Troubleshooting crashes with sanitizers can be challenging, but the detailed information they provide is invaluable for identifying and fixing memory errors. By carefully analyzing the stack trace, reviewing the source code, and reproducing the issue, you can track down the root cause and ensure the stability of your <code>systemd-oomd</code> service. Remember to take it step by step, guys, and you'll get there!</p>
<p>This detailed approach should help anyone facing similar issues with <code>systemd-oomd</code> or other systemd components crashing when running with sanitizers. Good luck, and happy debugging!</p>

                    </div>
                    <aside class="related-posts">
                        <div class="ad-sidebar container">
                            <!-- <div class="ad-wrapper">
    <span>Iklan Related</span>
</div> -->
                        </div>
                        <h2 class="related-posts-title">Related Posts</h2><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/speak-huttese-learn-jabba-the">Speak Huttese: Learn Jabba The Hutt&#39;s Language</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-07T03:11:08+00:00">Aug 7, 2025</time>
		                        <span class="view-count">
									46 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/calculating-phosphoric-acid-needed-for">Calculating Phosphoric Acid Needed For 0.710 Moles Of Potassium Phosphate</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-14T06:16:57+00:00">Jul 14, 2025</time>
		                        <span class="view-count">
									73 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/airbrushing-a-beginners-guide-to">Airbrushing: A Beginner&#39;s Guide To Techniques &amp; Equipment</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-10T16:24:21+00:00">Aug 10, 2025</time>
		                        <span class="view-count">
									57 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/sprint-41-phase-8-bidirectional">Sprint 41 Phase 8 Bidirectional Workflow Validation Test A Comprehensive Guide</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-23T17:49:58+00:00">Jul 23, 2025</time>
		                        <span class="view-count">
									78 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/wizard-and-manual-modes-boost">Wizard &amp; Manual Modes: Boost AI Question Creation</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-07T17:13:39+00:00">Aug 7, 2025</time>
		                        <span class="view-count">
									49 views
		                        </span>
                            </div>
                        </article>
                    </aside>
                    <aside class="related-posts"></aside>
                </div>
            </div>
        </article>
        <a href="#" class="back-to-top" id="backToTop" title="Back to top">
        	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-up" viewBox="0 0 16 16">
			  <path fill-rule="evenodd" d="M3.646 11.854a.5.5 0 0 0 .708 0L8 8.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708M2.4 5.2c0 .22.18.4.4.4h10.4a.4.4 0 0 0 0-.8H2.8a.4.4 0 0 0-.4.4"/>
			</svg>
		</a>
    </main>
    <footer class="footer">
        <div class="container">
            <p>© 2025 Question Notes</p>
        </div>
    </footer>
    <script>
    	(() => {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            const toggleMenu = () => {
                navMenu.classList.toggle('nav-menu-active');
                navToggle.classList.toggle('nav-toggle-active');
            };
            const backToTopHandler = (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            navToggle.addEventListener('click', toggleMenu);
            document.getElementById('backToTop').addEventListener('click', backToTopHandler);
            window.addEventListener('pagehide', () => {
                navToggle.removeEventListener('click', toggleMenu);
                document.getElementById('backToTop').removeEventListener('click', backToTopHandler);
            });
        })();
		(() => {
            window.addEventListener("DOMContentLoaded", (event) => {
                const ellHljs = document.createElement("script");
                ellHljs.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js");
                ellHljs.onload = () => {
                    hljs.highlightAll();
                };
                document.querySelector("body").append(ellHljs);
                const ellFont = document.createElement("link");
                ellFont.setAttribute("href", "https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css");
                ellFont.setAttribute("rel", "stylesheet");
                document.querySelector("head").append(ellFont);
                window.addEventListener('pagehide', () => {
                    // ellHljs.remove();
                    ellFont.remove();
                });

            });
        })();
    </script>
    <!-- Histats.com  START  (aync)-->
<script type="text/javascript">var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4957095,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
(function() {
var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
hs.src = ('//s10.histats.com/js15_as.js');
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();</script>
<!-- Histats.com  END  -->
    
    
</body>
</html>