<!DOCTYPE html>
<html lang="en">
<head>
	<title>Telegram Bot: Delete SQLite Records With Buttons In Python</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Telegram Bot: Delete SQLite Records With Buttons In Python...">
    <link rel="canonical" href="https://catatansoal.github.io/blog/telegram-bot-delete-sqlite-records">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Telegram Bot: Delete SQLite Records With Buttons In Python">
	<meta property="og:description" content="Telegram Bot: Delete SQLite Records With Buttons In Python...">
	<meta property="og:url" content="https://catatansoal.github.io/blog/telegram-bot-delete-sqlite-records">
	<meta property="og:site_name" content="ANABEL">
	<meta property="article:published_time" content="2025-08-08T09:09:30+00:00">
	<meta property="article:author" content="ADMIN">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js">
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <link rel="preload" fetchpriority="high" as="image" href="https://tse4.mm.bing.net/th?q=Deleting%20Records%20from%20SQLite3%20Database%20via%20Telegram%20Bot%20Buttons%20in%20Python">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style type="text/css">
    	:root{--primary-color:#3740ff;--text-color:#202124;--background-color:#ffffff;--gray-100:#f8f9fa;--gray-200:#e9ecef}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.6;color:var(--text-color);background-color:var(--background-color)}.container{max-width:1200px;margin:0 auto;padding:0 1.5rem}.header{background-color:var(--background-color);border-bottom:1px solid var(--gray-200);position:sticky;top:0;z-index:100}.nav{padding:.5rem 0}.nav-container{display:flex;justify-content:space-between;align-items:center;gap:1rem}.nav-left{display:flex;align-items:center;flex-shrink:0}.logo{font-weight:700;color:var(--primary-color)}.blog-tag{margin-left:1rem;padding:.25rem .5rem;background-color:var(--gray-100);border-radius:4px;font-size:.875rem}.nav-search{flex-grow:1;max-width:300px}.search-form{position:relative;width:100%}.search-input{width:100%;padding:.5rem 2.5rem .5rem 1rem;border:1px solid var(--gray-200);border-radius:24px;font-size:.875rem;transition:all 0.2s}.search-input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgb(55 64 255 / .1)}.search-button{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#5f6368;cursor:pointer;padding:.25rem;display:flex;align-items:center;justify-content:center}.search-button:hover{color:var(--primary-color)}.nav-toggle{display:none;background:none;border:none;cursor:pointer;padding:.5rem}.hamburger{display:block;position:relative;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before,.hamburger::after{content:'';position:absolute;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before{top:-6px}.hamburger::after{bottom:-6px}.nav-toggle-active .hamburger{background:#fff0}.nav-toggle-active .hamburger::before{transform:rotate(45deg);top:0}.nav-toggle-active .hamburger::after{transform:rotate(-45deg);bottom:0}.nav-list{display:flex;list-style:none;gap:2rem}.nav-link{color:var(--text-color);text-decoration:none;font-size:.9rem;transition:color 0.2s}.nav-link:hover{color:var(--primary-color)}.article-header{padding:2rem 0;background-color:var(--gray-100)}.article-layout{display:grid;grid-template-columns:1fr 350px;gap:3rem;padding:1rem 0;align-items: start}h1,h2,h3,h4,h5,h6{font-family:"Crimson Text","Times New Roman",Times,serif}h1{font-size:2.5rem;line-height:1.2;margin-bottom:1rem}.meta{color:#5f6368;font-size:.875rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.view-count{display:inline-flex;align-items:center;gap:.25rem}.view-count svg{color:#5f6368}.content{min-width:0;border-bottom:1px solid #dddddd5e;margin-top:1rem;white-space:pre-line !important;overflow-wrap:break-word;overflow-x:auto;word-break:break-word}.lead{font-size:1.25rem;color:#5f6368;margin-bottom:2rem}h2,h3,h4,h5,h6{font-size:1.75rem;margin:1rem 0 1rem}p,pre,ol,ul>li{margin-bottom:1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;font-size:1.3rem;text-align: justify;}p>code{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px}hr{margin:1rem 0 1rem 0}.code-example{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;margin:1.5rem 0;overflow-x:auto}code{font-family:'Roboto Mono',monospace;font-size:.875rem}ul{margin:.2rem 0;padding-left:1.5rem}.related-posts{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;position:sticky;top:5rem}.related-posts-title,.newpost-posts-list{font-size:1.75rem;margin:0 0 1rem}.related-posts-list{display:flex;flex-direction:column;gap:.5rem}.related-post,.newpost-post{border-bottom:1px solid #ddd;padding-bottom:10px;margin-bottom:10px}.related-post:last-child,.newpost-post:last-child{padding-bottom:0;border-bottom:none}.related-post-title,.newpost-post-title{font-size:1.2rem;margin:0 0 .1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;}.related-post-title a,.newpost-post-title a{color:var(--text-color);text-decoration:none;transition:color 0.2s}.related-post-title a:hover,.newpost-post-title a:hover{color:var(--primary-color)}.related-post time{font-size:.875rem;color:#5f6368}.footer{background-color:var(--gray-100);padding:2rem 0;margin-top:4rem;color:#5f6368;font-size:.875rem}.nav-menu>ul>li{margin-bottom:0}@media (max-width:1024px){.container{max-width:800px}.article-layout{grid-template-columns:1fr;gap:2rem}.related-posts{position:static}}@media (max-width:768px){.nav-container{flex-wrap:wrap}.nav-search{order:3;max-width:none;width:100%;margin-top:.1rem}.nav-toggle{display:block}.nav-menu{display:none;position:absolute;top:100%;left:0;right:0;background:var(--background-color);padding:1rem 0;border-bottom:1px solid var(--gray-200)}.nav-menu-active{display:block}.nav-list{flex-direction:column;gap:.1rem;padding:0 1.5rem}.nav-link{display:block;padding:.2rem 0}h1{font-size:2rem}.article-header{padding:2rem 0}.content{padding:.1rem 0}}table{width:100%;border-collapse:collapse;margin:20px 0;font-family:'Arial',sans-serif}th,td{padding:12px 15px;text-align:left;border:1px solid #ddd}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9}tr:nth-child(even) td{background-color:#f2f2f2}@media screen and (max-width:768px){table{border:0;display:block;overflow-x:auto;white-space:nowrap}th,td{padding:10px;text-align:right}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9;border-bottom:1px solid #ddd}tr:nth-child(even) td{background-color:#f2f2f2}}a{text-decoration:none;color:#540707}.katex-html{padding: .2rem;color: #000;font-weight: 700;font-size: 1.3rem;overflow-wrap: break-word;max-width: 100%;white-space: normal !important}.category{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;margin:1rem 0 1rem 0}.tag{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px;font-family:"Newsreader",serif}.tag>a{text-decoration:none;color:#000}img{margin:auto;display:block;max-width:100%;height:auto;margin-bottom:1rem}.katex{white-space: pre-line !important;display: inline-block;max-width: 100%;overflow-x: auto;overflow-y: hidden;scrollbar-width: thin;overflow-wrap: break-word;word-break: break-word;vertical-align: -7px}.content > p {overflow-wrap: break-word;word-break: break-word}
    </style>
    <style type="text/css">
    	pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}
		.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}
    	pre{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-weight:400;word-break:break-word;word-wrap:break-word;box-sizing:inherit;border-radius:4px;overflow-x:auto;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}code{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;word-wrap:break-word;word-break:break-word;font-style:normal;line-height:20px;letter-spacing:-.003em;box-sizing:inherit;font-weight:400;font-size:75%;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}
    </style>
    <style type="text/css">
    	.back-to-top{position:fixed;bottom:20px;right:20px;background-color:#a73f3f;color:#fff;padding:8px 10px;border-radius:50%;box-shadow:0 4px 6px rgb(0 0 0 / .2);font-size:10px;font-weight:700;text-decoration:none;text-align:center;transition:opacity 0.3s ease,visibility 0.3s ease;z-index:99999;opacity:1;visibility:visible}.back-to-top:hover{background-color:#0056b3}
    </style>
    <style type="text/css">
        .ad-header {margin: 1rem auto 1rem;background-color: #fdfdfd;text-align: center;display: block;}.ad-header .ad-wrapper {min-height: 90px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #555;font-weight: 500;padding: 3rem;border: 1px dashed #ccc;border-radius: 6px;}@media (max-width: 768px) {.ad-header {padding: 0.75rem;}}.ad-sidebar {margin: 0 0 1rem;background-color: #fefefe;text-align: center;padding: 0px;width: 100%;max-width: 100%;display: block;}.ad-sidebar .ad-wrapper {min-height: 250px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #444;font-weight: 500;border: 1px dashed #aaa;border-radius: 6px;padding: 0rem;}@media (max-width: 1024px) {.ad-sidebar {padding: 0.75rem;}}
    </style>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Article",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://catatansoal.github.io/blog/telegram-bot-delete-sqlite-records"
          },
          "headline": "Telegram Bot: Delete SQLite Records With Buttons In Python",
          "description": "Telegram Bot: Delete SQLite Records With Buttons In Python...",
          "image": [
            "https://tse4.mm.bing.net/th?q=Deleting%20Records%20from%20SQLite3%20Database%20via%20Telegram%20Bot%20Buttons%20in%20Python"
          ],
          "author": {
            "@type": "Person",
            "name": "ADMIN",
            "jobTitle": "Editor web"
          },
          "publisher": {
            "@type": "Organization",
            "name": "ANABEL",
            "logo": {
              "@type": "ImageObject",
              "url": "https://tse4.mm.bing.net/th?q=ANABEL%20WEB"
            }
          },
          "datePublished": "2025-08-08T09:09:30+00:00",
          "dateModified": "2025-08-08T09:09:30+00:00"
        }
    </script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container nav-container">
                <div class="nav-left">
                    <span class="logo">ANABEL</span>
                    <span class="blog-tag">Article</span>
                </div>
                <div class="nav-search">
                    <form class="search-form" role="search">
                        <input 
                            type="search" 
                            class="search-input"
                            placeholder="Search articles..."
                            aria-label="Search articles"
                        >
                        <button type="submit" class="search-button" aria-label="Submit search">ðŸ”Ž</button>
                    </form>
                </div>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span class="hamburger"></span>
                </button>
                <div class="nav-menu">
                    <ul class="nav-list">
                    	<li><a href="/" class="nav-link">HOME</a></li>
                        <li><a href="/pages/About" class="nav-link">About</a></li>
                        <li><a href="/pages/Contact" class="nav-link">Contact</a></li>
                        <li><a href="/pages/Disclaimer" class="nav-link">Disclaimer</a></li>
                        <li><a href="/pages/Privacy" class="nav-link">Privacy</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="main">
        <article class="article">
            <header class="article-header">
                <div class="container">
                    <h1>Telegram Bot: Delete SQLite Records With Buttons In Python</h1>
                    <div class="meta">
                        <time datetime="2025-08-08T09:09:30+00:00">Aug 8, 2025</time>
                        <span class="author">by ADMIN</span>
                        <span class="view-count">
                            <span id="viewCount">59</span> views
                        </span>
                    </div>
                </div>
            </header>
            <div class="ad-header container">
                <div class="ad-wrapper">
    Iklan Headers
</div>
            </div>
            <div class="container">
                <div class="article-layout">
                    <div class="content">
                        <img src="https://tse4.mm.bing.net/th?q=Deleting%20Records%20from%20SQLite3%20Database%20via%20Telegram%20Bot%20Buttons%20in%20Python" title="Deleting Records from SQLite3 Database via Telegram Bot Buttons in Python" width="300" height="200"/><p>Hey guys! Ever wanted to create a Telegram bot that interacts with an SQLite3 database, allowing users to delete records with the simple tap of a button? Well, you've come to the right place! This article will guide you through the process, providing a comprehensive understanding of how to implement this functionality using the <code>pyTelegramBotAPI</code> and <code>sqlite3</code> libraries in Python. We'll break down each step, ensuring you grasp the core concepts and can apply them to your own projects. So, grab your coding gloves, and let's dive in!</p>
<h2>Setting Up the Stage: Understanding the Core Components</h2>
<p>Before we jump into the code, let's get a handle on the key components we'll be using:</p>
<ul>
<li><strong><code>pyTelegramBotAPI</code>:</strong> This is our trusty library for interacting with the Telegram Bot API. It simplifies sending messages, handling updates, and all the other bot-related magic.</li>
<li><strong><code>sqlite3</code>:</strong> This built-in Python library allows us to work with SQLite databases, which are perfect for storing structured data in a lightweight and portable manner.</li>
</ul>
<p>Our mission is to create a Telegram bot command that:</p>
<ol>
<li>Fetches all records from the database associated with the current user.</li>
<li>Displays these records to the user in a readable format.</li>
<li>Adds an inline button under each record, labeled something like &quot;Delete&quot;, allowing the user to trigger the deletion process.</li>
<li>Handles the button press, deleting the corresponding record from the database.</li>
</ol>
<p>This involves a few key steps: setting up the database connection, creating the bot, defining the command handler, generating the inline keyboard, handling the callback query (button press), and finally, deleting the record. Let's get started with the database setup.</p>
<h2>Laying the Foundation: Setting Up the SQLite3 Database</h2>
<p>First things first, we need a database to work with. Let's create a simple SQLite3 database with a table to store some user-related data. Imagine we're building a task management bot, so our table might store tasks with descriptions and user IDs. Hereâ€™s how you can create and connect to a database:</p>
<pre><code class="hljs">import sqlite3

# Connect to the database (or create it if it doesn&#39;t exist)
conn = sqlite3.connect(&#39;tasks.db&#39;)
cursor = conn.cursor()

# Create a table (if it doesn&#39;t exist)
cursor.execute(&#39;&#39;&#39;
    CREATE TABLE IF NOT EXISTS tasks (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_id INTEGER,
        description TEXT
    )
&#39;&#39;&#39;)
conn.commit()

# Example: Inserting some sample data
cursor.execute(&quot;INSERT INTO tasks (user_id, description) VALUES (?, ?)&quot;, (123, &#39;Buy groceries&#39;))
cursor.execute(&quot;INSERT INTO tasks (user_id, description) VALUES (?, ?)&quot;, (123, &#39;Walk the dog&#39;))
cursor.execute(&quot;INSERT INTO tasks (user_id, description) VALUES (?, ?)&quot;, (456, &#39;Pay bills&#39;))
conn.commit()

conn.close()
</code></pre>
<p>In this snippet, we:</p>
<ol>
<li>Import the <code>sqlite3</code> library.</li>
<li>Connect to a database named <code>tasks.db</code>. If it doesnâ€™t exist, SQLite will create it for us.</li>
<li>Create a cursor object, which allows us to execute SQL commands.</li>
<li>Define a table named <code>tasks</code> with columns for <code>id</code>, <code>user_id</code>, and <code>description</code>. The <code>id</code> column is set as the primary key with autoincrement, which means it will automatically generate unique IDs for new records. The <code>user_id</code> column is an integer to store the Telegram user ID, and the <code>description</code> column is text to store the task description.</li>
<li>Commit the changes to the database.</li>
<li>Insert some sample data into the <code>tasks</code> table. We insert three tasks, two for user ID <code>123</code> and one for user ID <code>456</code>. This will give us something to work with when we fetch and display records later.</li>
<li>Commit the changes again.</li>
<li>Close the database connection.</li>
</ol>
<p><strong>Remember to always close the connection</strong> after you're done with database operations to free up resources and prevent potential issues. This is a crucial step for maintaining database integrity.</p>
<h2>Bootstrapping the Bot: Setting Up the Telegram Bot</h2>
<p>Now that our database is ready, let's set up our Telegram bot. This involves creating a bot instance using the <code>pyTelegramBotAPI</code> library. You'll need a bot token, which you can obtain from BotFather on Telegram. Hereâ€™s how you can do it:</p>
<pre><code class="hljs">import telebot

# Replace &#39;YOUR_BOT_TOKEN&#39; with your actual bot token
BOT_TOKEN = &#39;YOUR_BOT_TOKEN&#39;

# Create a bot instance
bot = telebot.TeleBot(BOT_TOKEN)

print(&quot;Bot is running...&quot;)

# This function will handle /start command
@bot.message_handler(commands=[&#39;start&#39;])
def start(message):
    bot.reply_to(message, &quot;Hello! I&#39;m your task management bot. Use /tasks to see your tasks.&quot;)

# Start listening for incoming messages
bot.infinity_polling()
</code></pre>
<p>In this code:</p>
<ol>
<li>We import the <code>telebot</code> library (which is <code>pyTelegramBotAPI</code>).</li>
<li>We define a <code>BOT_TOKEN</code> variable and <strong>replace <code>'YOUR_BOT_TOKEN'</code> with the actual token</strong> you received from BotFather. This token is your bot's unique identifier and is used to authenticate your bot with the Telegram API. Keep it safe and don't share it with anyone!</li>
<li>We create an instance of the <code>TeleBot</code> class, passing in the <code>BOT_TOKEN</code>. This creates our bot object, which we'll use to interact with the Telegram API.</li>
<li>We print a message to the console indicating that the bot is running. This is helpful for debugging and knowing when your bot is online.</li>
<li>We define a message handler for the <code>/start</code> command using the <code>@bot.message_handler</code> decorator. This decorator tells the bot to call the <code>start</code> function whenever it receives a message with the <code>/start</code> command.</li>
<li>Inside the <code>start</code> function, we use <code>bot.reply_to(message, ...)</code> to send a reply to the user who sent the <code>/start</code> command. The reply message is a simple greeting and instructions on how to use the bot.</li>
<li>Finally, we call <code>bot.infinity_polling()</code> to start the bot and make it listen for incoming messages. This function will keep the bot running and processing updates from Telegram.</li>
</ol>
<p>With this code in place, your bot is now online and ready to receive commands! You can send it the <code>/start</code> command and see the bot's response. The next step is to create the handler that will display the tasks from the database.</p>
<h2>Displaying Records with Inline Buttons: Crafting the <code>/tasks</code> Handler</h2>
<p>This is where the magic happens! We'll create a handler for the <code>/tasks</code> command that fetches records from the database, displays them to the user, and adds an inline button for each record. This is the core functionality we're aiming for. Here's how we can implement it:</p>
<pre><code class="hljs">@bot.message_handler(commands=[&#39;tasks&#39;])
def tasks(message):
    user_id = message.from_user.id
    conn = sqlite3.connect(&#39;tasks.db&#39;)
    cursor = conn.cursor()
    cursor.execute(&quot;SELECT id, description FROM tasks WHERE user_id = ?&quot;, (user_id,))
    tasks = cursor.fetchall()
    conn.close()

    if not tasks:
        bot.reply_to(message, &quot;You have no tasks!&quot;)
        return

    for task_id, description in tasks:
        keyboard = telebot.types.InlineKeyboardMarkup()
        delete_button = telebot.types.InlineKeyboardButton(&quot;Delete&quot;, callback_data=f&quot;delete:{task_id}&quot;)
        keyboard.add(delete_button)
        bot.send_message(message.chat.id, f&quot;Task: {description}&quot;, reply_markup=keyboard)
</code></pre>
<p>Let's break down this code snippet:</p>
<ol>
<li>We define a message handler for the <code>/tasks</code> command using the <code>@bot.message_handler</code> decorator, similar to the <code>/start</code> command handler.</li>
<li>Inside the <code>tasks</code> function, we first get the user's ID from the <code>message.from_user.id</code> attribute. This is how we identify which user is requesting their tasks.</li>
<li>We establish a connection to the <code>tasks.db</code> database and create a cursor object, just like we did before.</li>
<li>We execute a SQL query to select the <code>id</code> and <code>description</code> from the <code>tasks</code> table, but this time, we add a <code>WHERE</code> clause to filter the results based on the <code>user_id</code>. This ensures that we only fetch tasks that belong to the current user. We use a parameterized query with a placeholder <code>?</code> and pass the <code>user_id</code> as a tuple to prevent SQL injection vulnerabilities. This is a <strong>crucial security measure</strong> you should always use when constructing SQL queries with user-provided input.</li>
<li>We fetch all the results using <code>cursor.fetchall()</code>, which returns a list of tuples, where each tuple represents a row from the database. Each tuple will contain the <code>task_id</code> and the <code>description</code>.</li>
<li>We close the database connection.</li>
<li>We check if the <code>tasks</code> list is empty. If it is, we send a reply to the user indicating that they have no tasks and return from the function. This prevents us from trying to display tasks when there aren't any.</li>
<li>If there are tasks, we iterate over the <code>tasks</code> list. For each task:
<ul>
<li>We create an <code>InlineKeyboardMarkup</code> object. This is the object that will hold our inline buttons.</li>
<li>We create an <code>InlineKeyboardButton</code> object with the text &quot;Delete&quot; and a <code>callback_data</code>. The <code>callback_data</code> is a string that will be sent to the bot when the button is pressed. We set it to <code>f&quot;delete:{task_id}&quot;</code>, which means it will be a string like &quot;delete:1&quot; or &quot;delete:2&quot;, where the number is the ID of the task we want to delete. This is how we associate the button press with the specific task.</li>
<li>We add the <code>delete_button</code> to the <code>keyboard</code>.</li>
<li>We send a message to the user containing the task description, and we set the <code>reply_markup</code> parameter to the <code>keyboard</code> object. This tells the Telegram API to display the inline buttons under the message.</li>
</ul>
</li>
</ol>
<p>Now, when a user sends the <code>/tasks</code> command, the bot will fetch their tasks from the database and display them with a &quot;Delete&quot; button under each task. The next step is to handle the button press and delete the corresponding task.</p>
<h2>Handling the Button Press: Implementing the Callback Query Handler</h2>
<p>When a user presses an inline button, the bot receives a callback query. We need to create a handler to process these queries and perform the deletion. This is where we link the button press to the database operation. Here's the code:</p>
<pre><code class="hljs">@bot.callback_query_handler(func=lambda call: call.data.startswith(&#39;delete:&#39;))
def delete_task(call):
    task_id = call.data.split(&#39;:&#39;)[1]
    user_id = call.from_user.id
    conn = sqlite3.connect(&#39;tasks.db&#39;)
    cursor = conn.cursor()
    cursor.execute(&quot;DELETE FROM tasks WHERE id = ? AND user_id = ?&quot;, (task_id, user_id))
    conn.commit()
    conn.close()
    bot.answer_callback_query(call.id, &quot;Task deleted!&quot;)
    bot.edit_message_text(f&quot;Task deleted!&quot;, call.message.chat.id, call.message.message_id)
</code></pre>
<p>Let's break this down:</p>
<ol>
<li>We use the <code>@bot.callback_query_handler</code> decorator to define a callback query handler. The <code>func</code> parameter is a lambda function that checks if the <code>call.data</code> (the data associated with the button press) starts with &quot;delete:&quot;. This ensures that this handler only processes callback queries from our &quot;Delete&quot; buttons.</li>
<li>Inside the <code>delete_task</code> function:
<ul>
<li>We extract the <code>task_id</code> from the <code>call.data</code> by splitting the string at the colon (<code>:</code>) and taking the second element. This gives us the ID of the task to delete.</li>
<li>We get the user's ID from <code>call.from_user.id</code>.</li>
<li>We connect to the database and create a cursor.</li>
<li>We execute a SQL <code>DELETE</code> statement to remove the task from the <code>tasks</code> table. We use a <code>WHERE</code> clause to ensure that we only delete the task with the specified <code>id</code> <em>and</em> belonging to the current <code>user_id</code>. This is <strong>another crucial security measure</strong> to prevent users from deleting each other's tasks. Again, we use a parameterized query to prevent SQL injection.</li>
<li>We commit the changes to the database and close the connection.</li>
<li>We use <code>bot.answer_callback_query(call.id, &quot;Task deleted!&quot;)</code> to send a notification to the user that the task has been deleted. This is a small pop-up message that appears at the bottom of the screen.</li>
<li>We use <code>bot.edit_message_text(f&quot;Task deleted!&quot;, call.message.chat.id, call.message.message_id)</code> to edit the original message (the one displaying the task and the button). We replace the task description with &quot;Task deleted!&quot;. This provides visual feedback to the user that the task has been successfully deleted.</li>
</ul>
</li>
</ol>
<p>With this handler in place, pressing the &quot;Delete&quot; button will now delete the corresponding task from the database and update the message in the chat.</p>
<h2>Putting It All Together: The Complete Code</h2>
<p>Here's the complete code, combining all the pieces we've discussed:</p>
<pre><code class="hljs">import telebot
import sqlite3

# Replace &#39;YOUR_BOT_TOKEN&#39; with your actual bot token
BOT_TOKEN = &#39;YOUR_BOT_TOKEN&#39;

# Create a bot instance
bot = telebot.TeleBot(BOT_TOKEN)

# Connect to the database (or create it if it doesn&#39;t exist)
conn = sqlite3.connect(&#39;tasks.db&#39;)
cursor = conn.cursor()

# Create a table (if it doesn&#39;t exist)
cursor.execute(&#39;&#39;&#39;
    CREATE TABLE IF NOT EXISTS tasks (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_id INTEGER,
        description TEXT
    )
&#39;&#39;&#39;)
conn.commit()
conn.close()

print(&quot;Bot is running...&quot;)

# This function will handle /start command
@bot.message_handler(commands=[&#39;start&#39;])
def start(message):
    bot.reply_to(message, &quot;Hello! I&#39;m your task management bot. Use /tasks to see your tasks.&quot;)

@bot.message_handler(commands=[&#39;tasks&#39;])
def tasks(message):
    user_id = message.from_user.id
    conn = sqlite3.connect(&#39;tasks.db&#39;)
    cursor = conn.cursor()
    cursor.execute(&quot;SELECT id, description FROM tasks WHERE user_id = ?&quot;, (user_id,))
    tasks = cursor.fetchall()
    conn.close()

    if not tasks:
        bot.reply_to(message, &quot;You have no tasks!&quot;)
        return

    for task_id, description in tasks:
        keyboard = telebot.types.InlineKeyboardMarkup()
        delete_button = telebot.types.InlineKeyboardButton(&quot;Delete&quot;, callback_data=f&quot;delete:{task_id}&quot;)
        keyboard.add(delete_button)
        bot.send_message(message.chat.id, f&quot;Task: {description}&quot;, reply_markup=keyboard)

@bot.callback_query_handler(func=lambda call: call.data.startswith(&#39;delete:&#39;))
def delete_task(call):
    task_id = call.data.split(&#39;:&#39;)[1]
    user_id = call.from_user.id
    conn = sqlite3.connect(&#39;tasks.db&#39;)
    cursor = conn.cursor()
    cursor.execute(&quot;DELETE FROM tasks WHERE id = ? AND user_id = ?&quot;, (task_id, user_id))
    conn.commit()
    conn.close()
    bot.answer_callback_query(call.id, &quot;Task deleted!&quot;)
    bot.edit_message_text(f&quot;Task deleted!&quot;, call.message.chat.id, call.message.message_id)

# Start listening for incoming messages
bot.infinity_polling()
</code></pre>
<p>To run this code:</p>
<ol>
<li><strong>Replace <code>'YOUR_BOT_TOKEN'</code> with your actual bot token.</strong></li>
<li>Make sure you have the <code>pyTelegramBotAPI</code> library installed. If not, you can install it using pip: <code>pip install pyTelegramBotAPI</code>.</li>
<li>Save the code as a Python file (e.g., <code>telegram_bot.py</code>).</li>
<li>Run the file from your terminal: <code>python telegram_bot.py</code>.</li>
<li>Send the <code>/start</code> command to your bot on Telegram.</li>
<li>Send the <code>/tasks</code> command to see your tasks with delete buttons.</li>
<li>Press the delete button to delete the task.</li>
</ol>
<h2>Taking it Further: Enhancements and Best Practices</h2>
<p>This is a solid foundation, but there's always room for improvement! Here are some ideas for enhancements and best practices to consider:</p>
<ul>
<li><strong>Error Handling:</strong> Implement robust error handling to gracefully handle database connection issues, SQL errors, and other potential exceptions. Use <code>try...except</code> blocks to catch exceptions and log them or send informative messages to the user.</li>
<li><strong>Logging:</strong> Use a logging library (like Python's built-in <code>logging</code> module) to log important events, errors, and debugging information. This can be invaluable for troubleshooting and monitoring your bot's behavior.</li>
<li><strong>Database Connection Management:</strong> Instead of opening and closing the database connection for each request, consider using a connection pool or a context manager to manage database connections more efficiently. This can improve performance, especially with frequent database interactions.</li>
<li><strong>Data Validation and Sanitization:</strong> Always validate and sanitize user input before using it in SQL queries. This helps prevent SQL injection vulnerabilities and ensures data integrity.</li>
<li><strong>Pagination:</strong> If you have a large number of tasks, implement pagination to display them in smaller chunks. This improves the user experience and prevents the bot from sending excessively long messages.</li>
<li><strong>Asynchronous Operations:</strong> For more complex bots, consider using asynchronous operations (e.g., with the <code>asyncio</code> library) to handle long-running tasks without blocking the bot's event loop. This can improve responsiveness and prevent the bot from becoming unresponsive.</li>
</ul>
<h2>Conclusion: You've Done It!</h2>
<p>Congratulations! You've successfully built a Telegram bot that interacts with an SQLite3 database and allows users to delete records with inline buttons. This is a powerful technique that can be applied to a wide range of use cases, from task management to data management and beyond. Remember the key concepts we've covered: setting up the database, creating the bot, handling commands, generating inline keyboards, handling callback queries, and performing database operations.</p>
<p>By understanding these principles and applying the code examples in this article, you're well-equipped to create your own interactive Telegram bots that leverage the power of databases. Keep experimenting, keep learning, and keep building awesome bots!</p>

                    </div>
                    <aside class="related-posts">
                        <div class="ad-sidebar container">
                            <div class="ad-wrapper">
    <span>Iklan Related</span>
</div>
                        </div>
                        <h2 class="related-posts-title">Related Posts</h2><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/solving-for-q-in-the">Solving For Q In The Equation Q-12=89 A Step-by-Step Guide</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-14T04:52:45+00:00">Jul 14, 2025</time>
		                        <span class="view-count">
									58 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/deontology-vs-utilitarianism-is-there">Deontology Vs Utilitarianism Is There A Real Difference?</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-21T15:43:08+00:00">Jul 21, 2025</time>
		                        <span class="view-count">
									56 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/workflows-enhancement-feature-request-verify">Workflows Enhancement Feature Request Verify Step To Check For Hallucinations</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-23T17:01:39+00:00">Jul 23, 2025</time>
		                        <span class="view-count">
									77 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/calculating-electron-flow-a-physics">Calculating Electron Flow A Physics Problem Solved</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-14T03:37:24+00:00">Jul 14, 2025</time>
		                        <span class="view-count">
									50 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/fixing-phyloseq-crash-single-sample">Fixing Phyloseq Crash: Single-Sample Analysis</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-08T13:51:30+00:00">Aug 8, 2025</time>
		                        <span class="view-count">
									45 views
		                        </span>
                            </div>
                        </article>
                    </aside>
                    <aside class="related-posts"></aside>
                </div>
            </div>
        </article>
        <a href="#" class="back-to-top" id="backToTop" title="Back to top">
        	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-up" viewBox="0 0 16 16">
			  <path fill-rule="evenodd" d="M3.646 11.854a.5.5 0 0 0 .708 0L8 8.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708M2.4 5.2c0 .22.18.4.4.4h10.4a.4.4 0 0 0 0-.8H2.8a.4.4 0 0 0-.4.4"/>
			</svg>
		</a>
    </main>
    <footer class="footer">
        <div class="container">
            <p>Â© 2025 ANABEL</p>
        </div>
    </footer>
    <script>
    	(() => {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            const toggleMenu = () => {
                navMenu.classList.toggle('nav-menu-active');
                navToggle.classList.toggle('nav-toggle-active');
            };
            const backToTopHandler = (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            navToggle.addEventListener('click', toggleMenu);
            document.getElementById('backToTop').addEventListener('click', backToTopHandler);
            window.addEventListener('pagehide', () => {
                navToggle.removeEventListener('click', toggleMenu);
                document.getElementById('backToTop').removeEventListener('click', backToTopHandler);
            });
        })();
		(() => {
            window.addEventListener("DOMContentLoaded", (event) => {
                const ellHljs = document.createElement("script");
                ellHljs.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js");
                ellHljs.onload = () => {
                    hljs.highlightAll();
                };
                document.querySelector("body").append(ellHljs);
                const ellFont = document.createElement("link");
                ellFont.setAttribute("href", "https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css");
                ellFont.setAttribute("rel", "stylesheet");
                document.querySelector("head").append(ellFont);
                window.addEventListener('pagehide', () => {
                    // ellHljs.remove();
                    ellFont.remove();
                });

            });
        })();
    </script>
    
    
    
</body>
</html>