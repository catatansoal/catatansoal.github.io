<!DOCTYPE html>
<html lang="en">
<head>
	<title>Refactoring Onyx.connect() Removing SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END In SubscriptionUtils.ts</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Refactoring Onyx.connect() Removing SHARED NVP PRIVATE USER BILLING GRACE PERIOD END In SubscriptionUtils.ts...">
    <link rel="canonical" href="https://catatansoal.github.io/blog/refactoring-onyx-connect-removing-shared">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Refactoring Onyx.connect() Removing SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END In SubscriptionUtils.ts">
	<meta property="og:description" content="Refactoring Onyx.connect() Removing SHARED NVP PRIVATE USER BILLING GRACE PERIOD END In SubscriptionUtils.ts...">
	<meta property="og:url" content="https://catatansoal.github.io/blog/refactoring-onyx-connect-removing-shared">
	<meta property="og:site_name" content="Question Notes">
	<meta property="article:published_time" content="2025-07-17T09:05:21+00:00">
	<meta property="article:author" content="ADMIN">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js">
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <link rel="preload" fetchpriority="high" as="image" href="https://tse4.mm.bing.net/th?q=Refactoring%20Onyx.connect()%20Removing%20SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END%20in%20SubscriptionUtils.ts">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style type="text/css">
    	:root{--primary-color:#3740ff;--text-color:#202124;--background-color:#ffffff;--gray-100:#f8f9fa;--gray-200:#e9ecef}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.6;color:var(--text-color);background-color:var(--background-color)}.container{max-width:1200px;margin:0 auto;padding:0 1.5rem}.header{background-color:var(--background-color);border-bottom:1px solid var(--gray-200);position:sticky;top:0;z-index:100}.nav{padding:.5rem 0}.nav-container{display:flex;justify-content:space-between;align-items:center;gap:1rem}.nav-left{display:flex;align-items:center;flex-shrink:0}.logo{font-weight:700;color:var(--primary-color)}.blog-tag{margin-left:1rem;padding:.25rem .5rem;background-color:var(--gray-100);border-radius:4px;font-size:.875rem}.nav-search{flex-grow:1;max-width:300px}.search-form{position:relative;width:100%}.search-input{width:100%;padding:.5rem 2.5rem .5rem 1rem;border:1px solid var(--gray-200);border-radius:24px;font-size:.875rem;transition:all 0.2s}.search-input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgb(55 64 255 / .1)}.search-button{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#5f6368;cursor:pointer;padding:.25rem;display:flex;align-items:center;justify-content:center}.search-button:hover{color:var(--primary-color)}.nav-toggle{display:none;background:none;border:none;cursor:pointer;padding:.5rem}.hamburger{display:block;position:relative;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before,.hamburger::after{content:'';position:absolute;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before{top:-6px}.hamburger::after{bottom:-6px}.nav-toggle-active .hamburger{background:#fff0}.nav-toggle-active .hamburger::before{transform:rotate(45deg);top:0}.nav-toggle-active .hamburger::after{transform:rotate(-45deg);bottom:0}.nav-list{display:flex;list-style:none;gap:2rem}.nav-link{color:var(--text-color);text-decoration:none;font-size:.9rem;transition:color 0.2s}.nav-link:hover{color:var(--primary-color)}.article-header{padding:2rem 0;background-color:var(--gray-100)}.article-layout{display:grid;grid-template-columns:1fr 350px;gap:3rem;padding:1rem 0;align-items: start}h1,h2,h3,h4,h5,h6{font-family:"Crimson Text","Times New Roman",Times,serif}h1{font-size:2.5rem;line-height:1.2;margin-bottom:1rem}.meta{color:#5f6368;font-size:.875rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.view-count{display:inline-flex;align-items:center;gap:.25rem}.view-count svg{color:#5f6368}.content{min-width:0;border-bottom:1px solid #dddddd5e;margin-top:1rem;white-space:pre-line !important;overflow-wrap:break-word;overflow-x:auto;word-break:break-word}.lead{font-size:1.25rem;color:#5f6368;margin-bottom:2rem}h2,h3,h4,h5,h6{font-size:1.75rem;margin:1rem 0 1rem}p,pre,ol,ul>li{margin-bottom:1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;font-size:1.3rem;text-align: justify;}p>code{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px}hr{margin:1rem 0 1rem 0}.code-example{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;margin:1.5rem 0;overflow-x:auto}code{font-family:'Roboto Mono',monospace;font-size:.875rem}ul{margin:.2rem 0;padding-left:1.5rem}.related-posts{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;position:sticky;top:5rem}.related-posts-title,.newpost-posts-list{font-size:1.75rem;margin:0 0 1rem}.related-posts-list{display:flex;flex-direction:column;gap:.5rem}.related-post,.newpost-post{border-bottom:1px solid #ddd;padding-bottom:10px;margin-bottom:10px}.related-post:last-child,.newpost-post:last-child{padding-bottom:0;border-bottom:none}.related-post-title,.newpost-post-title{font-size:1.2rem;margin:0 0 .1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;}.related-post-title a,.newpost-post-title a{color:var(--text-color);text-decoration:none;transition:color 0.2s}.related-post-title a:hover,.newpost-post-title a:hover{color:var(--primary-color)}.related-post time{font-size:.875rem;color:#5f6368}.footer{background-color:var(--gray-100);padding:2rem 0;margin-top:4rem;color:#5f6368;font-size:.875rem}.nav-menu>ul>li{margin-bottom:0}@media (max-width:1024px){.container{max-width:800px}.article-layout{grid-template-columns:1fr;gap:2rem}.related-posts{position:static}}@media (max-width:768px){.nav-container{flex-wrap:wrap}.nav-search{order:3;max-width:none;width:100%;margin-top:.1rem}.nav-toggle{display:block}.nav-menu{display:none;position:absolute;top:100%;left:0;right:0;background:var(--background-color);padding:1rem 0;border-bottom:1px solid var(--gray-200)}.nav-menu-active{display:block}.nav-list{flex-direction:column;gap:.1rem;padding:0 1.5rem}.nav-link{display:block;padding:.2rem 0}h1{font-size:2rem}.article-header{padding:2rem 0}.content{padding:.1rem 0}}table{width:100%;border-collapse:collapse;margin:20px 0;font-family:'Arial',sans-serif}th,td{padding:12px 15px;text-align:left;border:1px solid #ddd}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9}tr:nth-child(even) td{background-color:#f2f2f2}@media screen and (max-width:768px){table{border:0;display:block;overflow-x:auto;white-space:nowrap}th,td{padding:10px;text-align:right}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9;border-bottom:1px solid #ddd}tr:nth-child(even) td{background-color:#f2f2f2}}a{text-decoration:none;color:#540707}.katex-html{padding: .2rem;color: #000;font-weight: 700;font-size: 1.3rem;overflow-wrap: break-word;max-width: 100%;white-space: normal !important}.category{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;margin:1rem 0 1rem 0}.tag{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px;font-family:"Newsreader",serif}.tag>a{text-decoration:none;color:#000}img{margin:auto;display:block;max-width:100%;height:auto;margin-bottom:1rem}.katex{white-space: pre-line !important;display: inline-block;max-width: 100%;overflow-x: auto;overflow-y: hidden;scrollbar-width: thin;overflow-wrap: break-word;word-break: break-word;vertical-align: -7px}.content > p {overflow-wrap: break-word;word-break: break-word}
    </style>
    <style type="text/css">
    	pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}
		.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}
    	pre{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-weight:400;word-break:break-word;word-wrap:break-word;box-sizing:inherit;border-radius:4px;overflow-x:auto;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}code{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;word-wrap:break-word;word-break:break-word;font-style:normal;line-height:20px;letter-spacing:-.003em;box-sizing:inherit;font-weight:400;font-size:75%;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}
    </style>
    <style type="text/css">
    	.back-to-top{position:fixed;bottom:20px;right:20px;background-color:#a73f3f;color:#fff;padding:8px 10px;border-radius:50%;box-shadow:0 4px 6px rgb(0 0 0 / .2);font-size:10px;font-weight:700;text-decoration:none;text-align:center;transition:opacity 0.3s ease,visibility 0.3s ease;z-index:99999;opacity:1;visibility:visible}.back-to-top:hover{background-color:#0056b3}
    </style>
    <style type="text/css">
        .ad-header {margin: 1rem auto 1rem;background-color: #fdfdfd;text-align: center;display: block;}.ad-header .ad-wrapper {min-height: 90px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #555;font-weight: 500;padding: 3rem;border: 1px dashed #ccc;border-radius: 6px;}@media (max-width: 768px) {.ad-header {padding: 0.75rem;}}.ad-sidebar {margin: 0 0 1rem;background-color: #fefefe;text-align: center;padding: 0px;width: 100%;max-width: 100%;display: block;}.ad-sidebar .ad-wrapper {min-height: 250px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #444;font-weight: 500;border: 1px dashed #aaa;border-radius: 6px;padding: 0rem;}@media (max-width: 1024px) {.ad-sidebar {padding: 0.75rem;}}
    </style>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Article",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://catatansoal.github.io/blog/refactoring-onyx-connect-removing-shared"
          },
          "headline": "Refactoring Onyx.connect() Removing SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END In SubscriptionUtils.ts",
          "description": "Refactoring Onyx.connect() Removing SHARED NVP PRIVATE USER BILLING GRACE PERIOD END In SubscriptionUtils.ts...",
          "image": [
            "https://tse4.mm.bing.net/th?q=Refactoring%20Onyx.connect()%20Removing%20SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END%20in%20SubscriptionUtils.ts"
          ],
          "author": {
            "@type": "Person",
            "name": "ADMIN",
            "jobTitle": "Editor web"
          },
          "publisher": {
            "@type": "Organization",
            "name": "Question Notes",
            "logo": {
              "@type": "ImageObject",
              "url": "https://tse4.mm.bing.net/th?q=Question%20Notes"
            }
          },
          "datePublished": "2025-07-17T09:05:21+00:00",
          "dateModified": "2025-07-17T09:05:21+00:00"
        }
    </script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container nav-container">
                <div class="nav-left">
                    <span class="logo">Question Notes</span>
                    <span class="blog-tag">Article</span>
                </div>
                <div class="nav-search">
                    <form class="search-form" role="search">
                        <input 
                            type="search" 
                            class="search-input"
                            placeholder="Search articles..."
                            aria-label="Search articles"
                        >
                        <button type="submit" class="search-button" aria-label="Submit search">🔎</button>
                    </form>
                </div>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span class="hamburger"></span>
                </button>
                <div class="nav-menu">
                    <ul class="nav-list">
                    	<li><a href="/" class="nav-link">HOME</a></li>
                        <li><a href="/pages/About" class="nav-link">About</a></li>
                        <li><a href="/pages/Contact" class="nav-link">Contact</a></li>
                        <li><a href="/pages/Disclaimer" class="nav-link">Disclaimer</a></li>
                        <li><a href="/pages/Privacy" class="nav-link">Privacy</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="main">
        <article class="article">
            <header class="article-header">
                <div class="container">
                    <h1>Refactoring Onyx.connect() Removing SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END In SubscriptionUtils.ts</h1>
                    <div class="meta">
                        <time datetime="2025-07-17T09:05:21+00:00">Jul 17, 2025</time>
                        <span class="author">by ADMIN</span>
                        <span class="view-count">
                            <span id="viewCount">109</span> views
                        </span>
                    </div>
                </div>
            </header>
            <div class="ad-header container">
                <!-- <div class="ad-wrapper">
    Iklan Headers
</div> -->
            </div>
            <div class="container">
                <div class="article-layout">
                    <div class="content">
                        <img src="https://tse4.mm.bing.net/th?q=Refactoring%20Onyx.connect()%20Removing%20SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END%20in%20SubscriptionUtils.ts" title="Refactoring Onyx.connect() Removing SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END in SubscriptionUtils.ts" width="300" height="200"/><p>Hey guys! Today, we're diving deep into a crucial refactoring task within the Expensify app – specifically, removing the <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code> reference from <code>Onyx.connect()</code> in <code>SubscriptionUtils.ts</code>. This is a significant step in our ongoing efforts to deprecate <code>Onyx.connect</code>, as outlined in the parent issue <a href="https://github.com/Expensify/Expensify/issues/522215">here</a>. Let's break down why this is important, what we need to do, and how we're going to ensure a smooth transition. This article will guide you through the process, making sure we not only refactor effectively but also maintain the stability and reliability of our application. So, buckle up, and let’s get started!</p>
<h2>Understanding the Context</h2>
<p>Before we jump into the nitty-gritty, let's take a moment to understand the context. We're deprecating <code>Onyx.connect</code>, which is a method used to connect components to Onyx, our data storage solution. As we move away from this approach, we need to refactor code that uses it. This particular task focuses on removing the <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code> reference. This reference is tied to the grace period end for private user billing, and it's stored under the <code>ONYXKEYS.COLLECTION.SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code> key. You can find the specific line we're targeting in <code>src/libs/SubscriptionUtils.ts</code> at <a href="https://github.com/Expensify/App/blob/main/src/libs/SubscriptionUtils.ts">Line 168</a>. Understanding the why and where helps us approach the refactoring with clarity and purpose. This isn't just about deleting code; it's about evolving our architecture to be more maintainable and efficient. By understanding the bigger picture, we can make informed decisions and ensure our changes align with the overall goals of the project.</p>
<h2>Why Refactor?</h2>
<p>So, why are we doing this in the first place? Deprecating <code>Onyx.connect</code> is a strategic move to improve the codebase's maintainability and performance. Legacy methods can sometimes become bottlenecks or introduce complexities that hinder future development. By refactoring, we aim to: Simplify the data flow within our application.</p>
<ul>
<li><strong>Enhance performance</strong>: <code>Onyx.connect</code> might have performance implications that newer methods can address.</li>
<li><strong>Improve code readability</strong>: A cleaner codebase is easier to understand and maintain. Reduce the risk of bugs: By using more modern patterns, we can leverage better tooling and practices to prevent errors.</li>
</ul>
<p>This particular refactoring task, removing <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code>, is a piece of this larger puzzle. It's crucial because it directly impacts how we handle billing grace periods for private users. Ensuring this functionality remains robust and reliable throughout the refactoring process is paramount. We don't want to disrupt the user experience or introduce any billing-related issues. Therefore, a meticulous and test-driven approach is essential. We need to carefully analyze how this data is used, identify the best alternative approach, and thoroughly test our changes to guarantee a seamless transition.</p>
<h2>The Refactoring Process: A Step-by-Step Guide</h2>
<p>Now, let's get into the how. We'll follow a <strong>test-driven development (TDD)</strong> approach, which means we write tests before we write the code. This ensures that our refactoring doesn't break existing functionality and that we have a safety net as we make changes.</p>
<ol>
<li><strong>Create Unit Tests</strong>: Before touching the existing code, we'll write unit tests for the methods that use <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code>. These tests will serve as a baseline to ensure our refactored code behaves as expected. Think of these tests as a safety net – they'll catch any regressions we might introduce during the refactoring process. The more comprehensive our unit tests are, the more confident we can be in our changes. We need to consider various scenarios and edge cases to ensure we're covering all bases. This might involve testing different grace period scenarios, user types, and billing configurations. By thoroughly testing the existing functionality, we can confidently move on to the next step, knowing we have a solid foundation to build upon.</li>
<li><strong>Refactor the Methods</strong>: With our tests in place, we can now refactor the methods to remove the <code>Onyx.connect</code> dependency and the <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code> reference. This might involve using a different method to access the data or restructuring the code to eliminate the need for this specific Onyx key. This is where the core of the refactoring happens. We need to carefully analyze the existing code, identify the dependencies, and determine the best way to replace the <code>Onyx.connect</code> functionality. This might involve introducing new data structures, using different data access patterns, or even redesigning parts of the component. The key is to make the changes incrementally, testing after each step to ensure we're not introducing any regressions. We should also strive to make the code cleaner and more readable as we refactor, adhering to best practices and coding standards.</li>
<li><strong>Ensure Unit Tests Pass</strong>: After refactoring, we'll run our unit tests to ensure they still pass. If any tests fail, we'll need to debug and fix our code until all tests are green. This is a critical step in the TDD process. It validates that our changes haven't broken any existing functionality. If the tests are failing, it means we've likely introduced a bug or haven't fully understood the original code's behavior. We need to carefully analyze the failing tests, identify the root cause, and adjust our refactoring accordingly. This iterative process of refactoring and testing is what ensures the quality and reliability of our changes. We should also take this opportunity to review our tests and make sure they're still comprehensive and cover all the relevant scenarios.</li>
<li><strong>Reinforce Testing</strong>: To further ensure the robustness of our changes, we'll add functional tests and involve QA testing. Functional tests verify that the feature works as a whole, while QA testing provides a real-world perspective. Unit tests are great for isolated components, but functional tests ensure that the different parts of the system work together seamlessly. These tests might involve simulating user interactions, verifying data flows, and checking for expected outcomes. QA testing takes this a step further by involving actual users or testers who can explore the application and identify potential issues that might not be caught by automated tests. This comprehensive testing approach ensures that our refactoring doesn't introduce any unexpected side effects and that the application continues to function as expected.</li>
<li><strong>Decrease ESLint Warnings</strong>: Finally, we'll decrease the number of allowable ESLint warnings in our <code>package.json</code> file. This helps us maintain a clean codebase and prevent future uses of <code>Onyx.connect</code>. ESLint is a powerful tool for enforcing coding standards and identifying potential issues in our code. By reducing the number of allowed warnings, we're essentially tightening the rules and making it harder to introduce code that violates our standards. This helps us maintain a consistent codebase and prevent the reintroduction of deprecated methods like <code>Onyx.connect</code>. This step is a crucial part of the overall deprecation process, as it ensures that we're not just removing the existing instances but also preventing future uses.</li>
</ol>
<h2>Diving Deeper into Unit Testing</h2>
<p>Let's spend a bit more time talking about unit testing, as it's the cornerstone of our refactoring strategy. When crafting unit tests for methods using <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code>, we need to think about all the possible scenarios and edge cases. What happens if the grace period is active? What if it's expired? What if it's about to expire? What if the user doesn't have a grace period? We need to write tests for each of these scenarios to ensure our refactored code handles them correctly. Each test should focus on a specific aspect of the method's behavior. We should aim for tests that are: Independent: Each test should be self-contained and not rely on the outcome of other tests. Repeatable: The tests should produce the same results every time they're run. Fast: Unit tests should execute quickly so we can run them frequently. Clear: The purpose of each test should be easy to understand.</p>
<p>By writing comprehensive unit tests, we create a safety net that allows us to refactor with confidence. We can make changes to the code knowing that if we break something, the tests will catch it. This iterative process of writing tests, refactoring, and running tests is what makes TDD such a powerful technique for maintaining code quality.</p>
<h2>Refactoring Strategies and Techniques</h2>
<p>Now that we've covered the process, let's talk about some specific refactoring strategies we might employ. One common technique is to extract the logic that uses <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code> into a separate function. This makes it easier to test and refactor in isolation. We can then replace the <code>Onyx.connect</code> call with a different way of accessing the data, such as using a direct Onyx read or a different data fetching mechanism. Another strategy is to use dependency injection. This involves passing the data or dependencies that the method needs as arguments, rather than relying on global state or <code>Onyx.connect</code>. This makes the method more testable and less coupled to the Onyx store. When refactoring, it's crucial to: Keep changes small and incremental. Test after each change. Communicate with the team. Document the changes.</p>
<p>By following these guidelines, we can ensure a smooth and successful refactoring process. Remember, refactoring is not just about changing code; it's about improving the overall quality and maintainability of our application.</p>
<h2>Functional and QA Testing: The Bigger Picture</h2>
<p>While unit tests are essential, they only test individual units of code in isolation. To ensure that our changes work seamlessly within the larger application, we need functional and QA testing. Functional tests verify that the features that use the refactored code work as expected from a user's perspective. This might involve simulating user interactions, such as navigating to a specific page, performing an action, and verifying that the expected outcome occurs. For example, we might write a functional test that checks if the billing grace period is correctly displayed to the user after the refactoring. QA testing takes this a step further by involving human testers who can explore the application and identify potential issues that automated tests might miss. QA testers bring a real-world perspective and can uncover unexpected edge cases or usability issues. By combining unit, functional, and QA testing, we can create a comprehensive testing strategy that ensures the quality and reliability of our changes.</p>
<h2>Final Steps: ESLint and Code Cleanup</h2>
<p>Once we've completed the refactoring and testing, there's one final step: decreasing the number of allowable ESLint warnings. This is a crucial step in the deprecation process, as it helps prevent future uses of <code>Onyx.connect</code>. ESLint is a powerful tool for enforcing coding standards and identifying potential issues in our code. By reducing the number of allowed warnings, we're essentially tightening the rules and making it harder to introduce code that violates our standards. This helps us maintain a consistent codebase and prevent the reintroduction of deprecated methods. In addition to reducing ESLint warnings, we should also take this opportunity to review the code and identify any areas for improvement. This might involve: Removing dead code. Simplifying complex logic. Improving code readability. Adding comments or documentation.</p>
<p>By performing these final cleanup steps, we can ensure that our refactored code is not only functional but also maintainable and easy to understand.</p>
<h2>Conclusion</h2>
<p>Refactoring <code>Onyx.connect()</code> and removing <code>SHARED_NVP_PRIVATE_USER_BILLING_GRACE_PERIOD_END</code> from <code>SubscriptionUtils.ts</code> is a significant step in our journey to modernize the Expensify app. By following a test-driven approach, we can ensure that our changes are safe, reliable, and improve the overall quality of our codebase. Remember, this isn't just about removing code; it's about evolving our architecture to be more maintainable and efficient. By understanding the context, following the process, and collaborating effectively, we can successfully complete this refactoring and contribute to the long-term health of our application. So, let's get to work and make our codebase even better! Remember to create comprehensive unit tests, refactor incrementally, and involve the team in the process. Together, we can make this refactoring a success and pave the way for a more modern and maintainable Expensify app. Happy refactoring, everyone!</p>

                    </div>
                    <aside class="related-posts">
                        <div class="ad-sidebar container">
                            <!-- <div class="ad-wrapper">
    <span>Iklan Related</span>
</div> -->
                        </div>
                        <h2 class="related-posts-title">Related Posts</h2><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/jump-higher-in-volleyball-increase">Jump Higher In Volleyball: Increase Your Vertical</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-01T08:29:33+00:00">Aug 1, 2025</time>
		                        <span class="view-count">
									49 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/dhl-customer-service-uk-24">DHL Customer Service UK: 24-Hour Number &amp; Opening Times</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-12T10:58:45+00:00">Aug 12, 2025</time>
		                        <span class="view-count">
									55 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/crochet-crop-top-a-step">Crochet Crop Top: A Step-by-Step Guide To Style</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-01T20:23:05+00:00">Aug 1, 2025</time>
		                        <span class="view-count">
									47 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/oblique-pyramid-volume-calculation-with">Oblique Pyramid Volume Calculation With Hexagonal Base</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-13T21:20:31+00:00">Jul 13, 2025</time>
		                        <span class="view-count">
									54 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/uniqlo-customer-service-your-complete">Uniqlo Customer Service: Your Complete Guide</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-12T11:46:17+00:00">Aug 12, 2025</time>
		                        <span class="view-count">
									44 views
		                        </span>
                            </div>
                        </article>
                    </aside>
                    <aside class="related-posts"></aside>
                </div>
            </div>
        </article>
        <a href="#" class="back-to-top" id="backToTop" title="Back to top">
        	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-up" viewBox="0 0 16 16">
			  <path fill-rule="evenodd" d="M3.646 11.854a.5.5 0 0 0 .708 0L8 8.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708M2.4 5.2c0 .22.18.4.4.4h10.4a.4.4 0 0 0 0-.8H2.8a.4.4 0 0 0-.4.4"/>
			</svg>
		</a>
    </main>
    <footer class="footer">
        <div class="container">
            <p>© 2025 Question Notes</p>
        </div>
    </footer>
    <script>
    	(() => {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            const toggleMenu = () => {
                navMenu.classList.toggle('nav-menu-active');
                navToggle.classList.toggle('nav-toggle-active');
            };
            const backToTopHandler = (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            navToggle.addEventListener('click', toggleMenu);
            document.getElementById('backToTop').addEventListener('click', backToTopHandler);
            window.addEventListener('pagehide', () => {
                navToggle.removeEventListener('click', toggleMenu);
                document.getElementById('backToTop').removeEventListener('click', backToTopHandler);
            });
        })();
		(() => {
            window.addEventListener("DOMContentLoaded", (event) => {
                const ellHljs = document.createElement("script");
                ellHljs.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js");
                ellHljs.onload = () => {
                    hljs.highlightAll();
                };
                document.querySelector("body").append(ellHljs);
                const ellFont = document.createElement("link");
                ellFont.setAttribute("href", "https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css");
                ellFont.setAttribute("rel", "stylesheet");
                document.querySelector("head").append(ellFont);
                window.addEventListener('pagehide', () => {
                    // ellHljs.remove();
                    ellFont.remove();
                });

            });
        })();
    </script>
    <!-- Histats.com  START  (aync)-->
<script type="text/javascript">var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4957095,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
(function() {
var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
hs.src = ('//s10.histats.com/js15_as.js');
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();</script>
<!-- Histats.com  END  -->
    
    
</body>
</html>