<!DOCTYPE html>
<html lang="en">
<head>
	<title>LibreChat Update Bug Invalid Data With Azure Inception Jais Model</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LibreChat Update Bug Invalid Data With Azure Inception Jais Model...">
    <link rel="canonical" href="https://catatansoal.github.io/blog/librechat-update-bug-invalid-data">
	<meta property="og:type" content="article">
	<meta property="og:title" content="LibreChat Update Bug Invalid Data With Azure Inception Jais Model">
	<meta property="og:description" content="LibreChat Update Bug Invalid Data With Azure Inception Jais Model...">
	<meta property="og:url" content="https://catatansoal.github.io/blog/librechat-update-bug-invalid-data">
	<meta property="og:site_name" content="Question Notes">
	<meta property="article:published_time" content="2025-07-17T03:45:23+00:00">
	<meta property="article:author" content="ADMIN">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js">
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <link rel="preload" fetchpriority="high" as="image" href="https://tse4.mm.bing.net/th?q=LibreChat%20Update%20Bug%3A%20Invalid%20Data%20with%20Azure%20Inception%20Jais%20Model">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style type="text/css">
    	:root{--primary-color:#3740ff;--text-color:#202124;--background-color:#ffffff;--gray-100:#f8f9fa;--gray-200:#e9ecef}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.6;color:var(--text-color);background-color:var(--background-color)}.container{max-width:1200px;margin:0 auto;padding:0 1.5rem}.header{background-color:var(--background-color);border-bottom:1px solid var(--gray-200);position:sticky;top:0;z-index:100}.nav{padding:.5rem 0}.nav-container{display:flex;justify-content:space-between;align-items:center;gap:1rem}.nav-left{display:flex;align-items:center;flex-shrink:0}.logo{font-weight:700;color:var(--primary-color)}.blog-tag{margin-left:1rem;padding:.25rem .5rem;background-color:var(--gray-100);border-radius:4px;font-size:.875rem}.nav-search{flex-grow:1;max-width:300px}.search-form{position:relative;width:100%}.search-input{width:100%;padding:.5rem 2.5rem .5rem 1rem;border:1px solid var(--gray-200);border-radius:24px;font-size:.875rem;transition:all 0.2s}.search-input:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgb(55 64 255 / .1)}.search-button{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#5f6368;cursor:pointer;padding:.25rem;display:flex;align-items:center;justify-content:center}.search-button:hover{color:var(--primary-color)}.nav-toggle{display:none;background:none;border:none;cursor:pointer;padding:.5rem}.hamburger{display:block;position:relative;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before,.hamburger::after{content:'';position:absolute;width:24px;height:2px;background:var(--text-color);transition:all 0.3s}.hamburger::before{top:-6px}.hamburger::after{bottom:-6px}.nav-toggle-active .hamburger{background:#fff0}.nav-toggle-active .hamburger::before{transform:rotate(45deg);top:0}.nav-toggle-active .hamburger::after{transform:rotate(-45deg);bottom:0}.nav-list{display:flex;list-style:none;gap:2rem}.nav-link{color:var(--text-color);text-decoration:none;font-size:.9rem;transition:color 0.2s}.nav-link:hover{color:var(--primary-color)}.article-header{padding:2rem 0;background-color:var(--gray-100)}.article-layout{display:grid;grid-template-columns:1fr 350px;gap:3rem;padding:1rem 0;align-items: start}h1,h2,h3,h4,h5,h6{font-family:"Crimson Text","Times New Roman",Times,serif}h1{font-size:2.5rem;line-height:1.2;margin-bottom:1rem}.meta{color:#5f6368;font-size:.875rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.view-count{display:inline-flex;align-items:center;gap:.25rem}.view-count svg{color:#5f6368}.content{min-width:0;border-bottom:1px solid #dddddd5e;margin-top:1rem;white-space:pre-line !important;overflow-wrap:break-word;overflow-x:auto;word-break:break-word}.lead{font-size:1.25rem;color:#5f6368;margin-bottom:2rem}h2,h3,h4,h5,h6{font-size:1.75rem;margin:1rem 0 1rem}p,pre,ol,ul>li{margin-bottom:1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;font-size:1.3rem;text-align: justify;}p>code{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px}hr{margin:1rem 0 1rem 0}.code-example{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;margin:1.5rem 0;overflow-x:auto}code{font-family:'Roboto Mono',monospace;font-size:.875rem}ul{margin:.2rem 0;padding-left:1.5rem}.related-posts{background-color:var(--gray-100);padding:1.5rem;border-radius:8px;position:sticky;top:5rem}.related-posts-title,.newpost-posts-list{font-size:1.75rem;margin:0 0 1rem}.related-posts-list{display:flex;flex-direction:column;gap:.5rem}.related-post,.newpost-post{border-bottom:1px solid #ddd;padding-bottom:10px;margin-bottom:10px}.related-post:last-child,.newpost-post:last-child{padding-bottom:0;border-bottom:none}.related-post-title,.newpost-post-title{font-size:1.2rem;margin:0 0 .1rem;font-family:"Newsreader",serif;font-optical-sizing:auto;font-style:normal;display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;}.related-post-title a,.newpost-post-title a{color:var(--text-color);text-decoration:none;transition:color 0.2s}.related-post-title a:hover,.newpost-post-title a:hover{color:var(--primary-color)}.related-post time{font-size:.875rem;color:#5f6368}.footer{background-color:var(--gray-100);padding:2rem 0;margin-top:4rem;color:#5f6368;font-size:.875rem}.nav-menu>ul>li{margin-bottom:0}@media (max-width:1024px){.container{max-width:800px}.article-layout{grid-template-columns:1fr;gap:2rem}.related-posts{position:static}}@media (max-width:768px){.nav-container{flex-wrap:wrap}.nav-search{order:3;max-width:none;width:100%;margin-top:.1rem}.nav-toggle{display:block}.nav-menu{display:none;position:absolute;top:100%;left:0;right:0;background:var(--background-color);padding:1rem 0;border-bottom:1px solid var(--gray-200)}.nav-menu-active{display:block}.nav-list{flex-direction:column;gap:.1rem;padding:0 1.5rem}.nav-link{display:block;padding:.2rem 0}h1{font-size:2rem}.article-header{padding:2rem 0}.content{padding:.1rem 0}}table{width:100%;border-collapse:collapse;margin:20px 0;font-family:'Arial',sans-serif}th,td{padding:12px 15px;text-align:left;border:1px solid #ddd}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9}tr:nth-child(even) td{background-color:#f2f2f2}@media screen and (max-width:768px){table{border:0;display:block;overflow-x:auto;white-space:nowrap}th,td{padding:10px;text-align:right}th{background-color:#0F7F0B;color:#FFF}td{background-color:#f9f9f9;border-bottom:1px solid #ddd}tr:nth-child(even) td{background-color:#f2f2f2}}a{text-decoration:none;color:#540707}.katex-html{padding: .2rem;color: #000;font-weight: 700;font-size: 1.3rem;overflow-wrap: break-word;max-width: 100%;white-space: normal !important}.category{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;margin:1rem 0 1rem 0}.tag{font-size:1rem;font-weight:700;padding:.1rem .3rem .1rem .3rem;background:#0000000f;color:#000;border-radius:5px;font-family:"Newsreader",serif}.tag>a{text-decoration:none;color:#000}img{margin:auto;display:block;max-width:100%;height:auto;margin-bottom:1rem}.katex{white-space: pre-line !important;display: inline-block;max-width: 100%;overflow-x: auto;overflow-y: hidden;scrollbar-width: thin;overflow-wrap: break-word;word-break: break-word;vertical-align: -7px}.content > p {overflow-wrap: break-word;word-break: break-word}
    </style>
    <style type="text/css">
    	pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}
		.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}
    	pre{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-weight:400;word-break:break-word;word-wrap:break-word;box-sizing:inherit;border-radius:4px;overflow-x:auto;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}code{-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;word-wrap:break-word;word-break:break-word;font-style:normal;line-height:20px;letter-spacing:-.003em;box-sizing:inherit;font-weight:400;font-size:75%;font-family:source-code-pro,Menlo,Monaco,"Courier New",Courier,monospace}
    </style>
    <style type="text/css">
    	.back-to-top{position:fixed;bottom:20px;right:20px;background-color:#a73f3f;color:#fff;padding:8px 10px;border-radius:50%;box-shadow:0 4px 6px rgb(0 0 0 / .2);font-size:10px;font-weight:700;text-decoration:none;text-align:center;transition:opacity 0.3s ease,visibility 0.3s ease;z-index:99999;opacity:1;visibility:visible}.back-to-top:hover{background-color:#0056b3}
    </style>
    <style type="text/css">
        .ad-header {margin: 1rem auto 1rem;background-color: #fdfdfd;text-align: center;display: block;}.ad-header .ad-wrapper {min-height: 90px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #555;font-weight: 500;padding: 3rem;border: 1px dashed #ccc;border-radius: 6px;}@media (max-width: 768px) {.ad-header {padding: 0.75rem;}}.ad-sidebar {margin: 0 0 1rem;background-color: #fefefe;text-align: center;padding: 0px;width: 100%;max-width: 100%;display: block;}.ad-sidebar .ad-wrapper {min-height: 250px;display: flex;align-items: center;justify-content: center;font-size: 1rem;color: #444;font-weight: 500;border: 1px dashed #aaa;border-radius: 6px;padding: 0rem;}@media (max-width: 1024px) {.ad-sidebar {padding: 0.75rem;}}
    </style>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Article",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://catatansoal.github.io/blog/librechat-update-bug-invalid-data"
          },
          "headline": "LibreChat Update Bug Invalid Data With Azure Inception Jais Model",
          "description": "LibreChat Update Bug Invalid Data With Azure Inception Jais Model...",
          "image": [
            "https://tse4.mm.bing.net/th?q=LibreChat%20Update%20Bug%3A%20Invalid%20Data%20with%20Azure%20Inception%20Jais%20Model"
          ],
          "author": {
            "@type": "Person",
            "name": "ADMIN",
            "jobTitle": "Editor web"
          },
          "publisher": {
            "@type": "Organization",
            "name": "Question Notes",
            "logo": {
              "@type": "ImageObject",
              "url": "https://tse4.mm.bing.net/th?q=Question%20Notes"
            }
          },
          "datePublished": "2025-07-17T03:45:23+00:00",
          "dateModified": "2025-07-17T03:45:23+00:00"
        }
    </script>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="container nav-container">
                <div class="nav-left">
                    <span class="logo">Question Notes</span>
                    <span class="blog-tag">Article</span>
                </div>
                <div class="nav-search">
                    <form class="search-form" role="search">
                        <input 
                            type="search" 
                            class="search-input"
                            placeholder="Search articles..."
                            aria-label="Search articles"
                        >
                        <button type="submit" class="search-button" aria-label="Submit search">üîé</button>
                    </form>
                </div>
                <button class="nav-toggle" aria-label="Toggle navigation">
                    <span class="hamburger"></span>
                </button>
                <div class="nav-menu">
                    <ul class="nav-list">
                    	<li><a href="/" class="nav-link">HOME</a></li>
                        <li><a href="/pages/About" class="nav-link">About</a></li>
                        <li><a href="/pages/Contact" class="nav-link">Contact</a></li>
                        <li><a href="/pages/Disclaimer" class="nav-link">Disclaimer</a></li>
                        <li><a href="/pages/Privacy" class="nav-link">Privacy</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="main">
        <article class="article">
            <header class="article-header">
                <div class="container">
                    <h1>LibreChat Update Bug Invalid Data With Azure Inception Jais Model</h1>
                    <div class="meta">
                        <time datetime="2025-07-17T03:45:23+00:00">Jul 17, 2025</time>
                        <span class="author">by ADMIN</span>
                        <span class="view-count">
                            <span id="viewCount">66</span> views
                        </span>
                    </div>
                </div>
            </header>
            <div class="ad-header container">
                <!-- <div class="ad-wrapper">
    Iklan Headers
</div> -->
            </div>
            <div class="container">
                <div class="article-layout">
                    <div class="content">
                        <img src="https://tse4.mm.bing.net/th?q=LibreChat%20Update%20Bug%3A%20Invalid%20Data%20with%20Azure%20Inception%20Jais%20Model" title="LibreChat Update Bug: Invalid Data with Azure Inception Jais Model" width="300" height="200"/><p>Hey guys! We've got a bit of a situation on our hands with the latest LibreChat update. It seems like there's a bug causing some headaches when using the Inception Jais model from Azure, specifically the one specializing in Arabic. Let's dive into what's happening, why it's happening, and how we can hopefully get it fixed.</p>
<h2>The Issue: 500 Error from Azure Foundry</h2>
<p>Since the update to LibreChat, we've been seeing a <strong>500 error</strong> popping up from Azure Foundry whenever we try to use the Inception Jais model. This is a major bummer because the <strong><em>Inception Jais model</em></strong> is crucial for our Arabic language processing. It all started happening after a specific commit in LibreChat's history, somewhere between <code>b412455e9d8e5c8cb500c1d96d735a6bfc2d2d50</code> and <code>1060ae80401016ff8004e9991a010a316d545ad7</code>. It seems the <strong>latest LibreChat update</strong> breaks all chat completions to this endpoint, with a 500 error coming from Azure Foundry. If your focus is Arabic language processing, this issue could significantly impact your workflow and the functionality of your chat applications. Understanding the details of the error and the configuration involved is crucial for troubleshooting and finding a solution.</p>
<p>To give you a clearer picture, here's how we've configured LiteLLM for Jais:</p>
<pre><code class="hljs">  - model_name: &quot;[Inception] ÿ¨ÿ®ŸÑ ÿ¨ÿ≥ (Jais 30B Chat)&quot;
    litellm_params:
      model: azure/jais-30b-chat
      api_base: https://-----.openai.azure.com/
      api_version: &quot;2023-12-01-preview&quot;
    model_info:
      max_tokens: 7500
      max_input_tokens: 7500
</code></pre>
<p>And this is our <code>librechat.yaml</code> configuration for Jais:</p>
<pre><code class="hljs">    - name: &quot;Inception&quot;
      apiKey: &quot;-----&quot;
      baseURL: &quot;https://litellm.river.berkeley.edu&quot;
      iconURL: &quot;https://-----/jais.png&quot;
      models:
        default: [&quot;[Inception] ÿ¨ÿ®ŸÑ ÿ¨ÿ≥ (Jais 30B Chat)&quot;]
        fetch: false
      maxContextTokens: 8000
      titleConvo: true
      titleModel: &quot;gpt-3.5-turbo&quot;
      summarize: true
      summaryModel: &quot;gpt-3.5-turbo&quot;
      forcePrompt: false
      modelDisplayLabel: &quot;Inception&quot;
</code></pre>
<h3>Diving into the Azure Cloud Logs</h3>
<p>Let's peek at the full log of the 500 error from Azure cloud logs. This gives us a detailed look at what's going wrong behind the scenes. The logs provide valuable information, such as the timestamp of the error, the specific Azure resources involved, and the nature of the issue. By analyzing these logs, we can identify patterns, pinpoint the exact cause of the failure, and develop targeted solutions.</p>
<pre><code class="hljs">{
   &quot;callerIpAddress&quot;:&quot;34.214.132.***&quot;,
   &quot;category&quot;:&quot;RequestResponse&quot;,
   &quot;correlationId&quot;:&quot;f233bcb8-28c6-4458-995f-2bf5dda21e07&quot;,
   &quot;durationMs&quot;:808,
   &quot;event&quot;:&quot;ShoeboxCallResult&quot;,
   &quot;location&quot;:&quot;westus&quot;,
   &quot;operationName&quot;:&quot;ChatCompletions_Create&quot;,
   &quot;properties&quot;:&quot;{\&quot;apiName\&quot;:\&quot;Azure OpenAI API version 2023-12-01-preview\&quot;,\&quot;requestTime\&quot;:638882830531613810,\&quot;requestLength\&quot;:146,\&quot;responseTime\&quot;:638882830539701654,\&quot;responseLength\&quot;:0,\&quot;objectId\&quot;:\&quot;\&quot;,\&quot;streamType\&quot;:\&quot;Streaming\&quot;,\&quot;modelDeploymentName\&quot;:\&quot;jais-30b-chat\&quot;,\&quot;modelName\&quot;:\&quot;jais-30b-chat\&quot;,\&quot;modelVersion\&quot;:\&quot;3\&quot;}&quot;,
   &quot;resourceId&quot;:&quot;/SUBSCRIPTIONS/-----/RESOURCEGROUPS/WESTUS-EXCEPTION-RESOURCES/PROVIDERS/MICROSOFT.COGNITIVESERVICES/ACCOUNTS/WESTUSFOUNDRYL6939018995&quot;,
   &quot;resultSignature&quot;:&quot;500&quot;,
   &quot;time&quot;:&quot;2025-07-16T17:17:34.6780000Z&quot;,
   &quot;Tenant&quot;:&quot;westus&quot;
}
</code></pre>
<h3>The Culprit: <code>TypeError: unhashable type: 'dict'</code></h3>
<p>LiteLLM is reporting a rather nasty error, and it seems like the core issue is a <code>TypeError: unhashable type: 'dict'</code>. The error is triggered by the <strong><code>detect_language(msg[&quot;content&quot;])</code></strong> function, suggesting a problem with how language detection is being handled. This error is critical because it prevents the system from processing chat completions, effectively breaking the integration with the Jais model. Addressing this error requires a deep dive into the language detection logic within LiteLLM and how it interacts with the input data. This could involve debugging the data structures, understanding the expected input format, and identifying the specific point where the <code>dict</code> type is causing the <code>unhashable type</code> error. Here‚Äôs the full error message received from Azure by LiteLLM:</p>
<pre><code class="hljs">litellm.APIError: AzureException APIError - An error occurred during the request processing: unhashable type: &#39;dict&#39; | Type: TypeError |   + Exception Group Traceback (most recent call last):
|     |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/_utils.py&quot;, line 87, in collapse_excgroups
|     |     yield
|     |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py&quot;, line 190, in __call__
|     |     async with anyio.create_task_group() as task_group:
|     |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/anyio/_backends/_asyncio.py&quot;, line 680, in __aexit__
|     |     raise BaseExceptionGroup(
|     | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
|     +-+---------------- 1 ----------------
|       | Traceback (most recent call last):
|       |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/errors.py&quot;, line 164, in __call__
|       |     await self.app(scope, receive, _send)
|       |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py&quot;, line 189, in __call__
|       |     with collapse_excgroups():
|     ... (rest of the traceback)
|       |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/billingproxy/apis/jais/protocol.py&quot;, line 17, in detect_language
|       |     wset = set(word)
|       |            ^^^^^^^^^
|       | TypeError: unhashable type: &#39;dict&#39;
|       +------------------------------------
|   
|   During handling of the above exception, another exception occurred:
|   
|   Traceback (most recent call last):
|     File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/errors.py&quot;, line 164, in __call__
|       await self.app(scope, receive, _send)
|     File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py&quot;, line 189, in __call__
|       with collapse_excgroups():
| ... (rest of the traceback)
|       |   File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/billingproxy/apis/jais/protocol.py&quot;, line 17, in detect_language
|       |     wset = set(word)
|       |            ^^^^^^^^^
|   TypeError: unhashable type: &#39;dict&#39;
|   . Received Model Group=[Inception] ÿ¨ÿ®ŸÑ ÿ¨ÿ≥ (Jais 30B Chat)
Available Model Group Fallbacks=None LiteLLM Retried: 1 times, LiteLLM Max Retries: 2
</code></pre>
<p>The LibreChat UI throws up an error message as well, which is basically a truncated version of the LiteLLM error. It‚Äôs not pretty, but it confirms that the issue stems from the same <code>unhashable type: 'dict'</code> error within LiteLLM.</p>
<pre><code class="hljs">Something went wrong. Here&#39;s the specific error message we encountered: An error occurred while processing the request: litellm.APIError: AzureException APIError - An error occurred during the request processing: unhashable type: &#39;dict&#39; | Type: TypeError | + Exception Group Traceback (most recent call last):|| | File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/_utils.py&quot;, line 87, in collapse_excgroups|| | yield|| | File &quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py&quot;, line 19...
</code></pre>
<h2>Root Cause Analysis and Potential Solutions</h2>
<p>To effectively address the <strong><em>Azure Inception Jais model</em></strong> issue, it's essential to pinpoint the root cause and devise a targeted solution. The <code>TypeError: unhashable type: 'dict'</code> suggests that the <code>detect_language</code> function in <code>billingproxy/apis/jais/protocol.py</code> is receiving a dictionary when it expects a string or another hashable type. The traceback indicates the problem occurs when trying to create a set from the input, which requires hashable elements. By thoroughly examining the code, we can identify the exact point where the dictionary is being passed and understand why. Potential solutions may include:</p>
<ol>
<li><strong>Input Validation:</strong> Implement checks to ensure that the <code>detect_language</code> function receives the expected input type. If a dictionary is encountered, it should be converted to a string or handled appropriately.</li>
<li><strong>Data Structure Correction:</strong> Investigate the structure of the <code>msg[&quot;content&quot;]</code> variable to determine why it's a dictionary instead of a string. Adjust the data processing logic to extract the relevant string content before passing it to <code>detect_language</code>.</li>
<li><strong>Error Handling:</strong> Add specific error handling for the <code>TypeError</code> to prevent the application from crashing. This may involve logging the error, returning a user-friendly message, or attempting an alternative language detection method.</li>
<li><strong>Code Review:</strong> Review the changes introduced between the working and broken commits to identify any modifications that might have caused the issue. This can help in understanding the context and uncovering unintended side effects.</li>
<li><strong>Dependency Updates:</strong> Check for any recent updates to dependencies, such as LiteLLM or other language processing libraries, that might have introduced breaking changes. Ensure that the versions being used are compatible and stable.</li>
</ol>
<p>By following this structured approach, we can efficiently diagnose the issue and implement the most effective solution to restore functionality.</p>
<h2>Version Information</h2>
<p>To reiterate, the problematic change seems to have landed somewhere between these commits:</p>
<ul>
<li>After <code>https://github.com/danny-avila/LibreChat/commit/b412455e9d8e5c8cb500c1d96d735a6bfc2d2d50</code></li>
<li>Before <code>https://github.com/danny-avila/LibreChat/commit/1060ae80401016ff8004e9991a010a316d545ad7</code></li>
</ul>
<p>Knowing the specific range of commits helps narrow down the search for the culprit code change.</p>
<h2>Steps to Reproduce</h2>
<p>Want to see the error in action? Here‚Äôs how you can reproduce it:</p>
<ol>
<li>Configure LiteLLM and LibreChat as described in the &quot;What happened?&quot; section above.</li>
<li>Attempt a regular chat completion using the Jais model.</li>
</ol>
<p>This should trigger the 500 error and the <code>unhashable type: 'dict'</code> error in LiteLLM.</p>
<h2>Browser Information</h2>
<p>We've been seeing this issue in Chrome, but it might not be limited to just that browser. If you're experiencing it in other browsers, let us know!</p>
<h2>Relevant Log Output</h2>
<p>Here‚Äôs the log output from the LibreChat side of things, confirming the 500 error and the LiteLLM exception:</p>
<pre><code class="hljs">{
   &quot;code&quot;:&quot;500&quot;,
   &quot;error&quot;:{
      &quot;code&quot;:&quot;500&quot;,
      &quot;message&quot;:&quot;litellm.APIError: AzureException APIError - An error occurred during the request processing: unhashable type: &#39;dict&#39; | Type: TypeError | + Exception Group Traceback (most recent call last):|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/_utils.py\&quot;, line 87, in collapse_excgroups|| | yield|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py\&quot;, line 190, in __call__|| | async with anyio.create_task_group() as task_group:|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\&quot;, line 680, in __aexit__|| | raise BaseExceptionGroup(|| | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)|| +-+---------------- 1 ----------------|| | Traceback (most recent call last):|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/li...&quot;,
      &quot;param&quot;:null,
      &quot;type&quot;:null
   },
   &quot;headers&quot;:{
      
   },
   &quot;level&quot;:&quot;error&quot;,
   &quot;message&quot;:&quot;[api/server/controllers/agents/client.js #sendCompletion] Operation aborted litellm.APIError: AzureException APIError - An error occurred during the request processing: unhashable type: &#39;dict&#39; | Type: TypeError | + Exception Group Traceback (most recent call last):|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/_utils.py\&quot;, line 87, in collapse_excgroups|| | yield|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py\&quot;, line 190, in __call__|| | async with anyio.create_task_group() as task_group:|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\&quot;, line 680, in __aexit__|| | raise BaseExceptionGroup(|| | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)|| +-+---------------- 1 ----------------|| | Traceback (most recent call last):|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/li...&quot;,
   &quot;param&quot;:null,
   &quot;pregelTaskId&quot;:&quot;a08bc5e4-7780-5703-a13c-03706f27c206&quot;,
   &quot;requestID&quot;:null,
   &quot;stack&quot;:&quot;Error: litellm.APIError: AzureException APIError - An error occurred during the request processing: unhashable type: &#39;dict&#39; | Type: TypeError | + Exception Group Traceback (most recent call last):|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/_utils.py\&quot;, line 87, in collapse_excgroups|| | yield|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/base.py\&quot;, line 190, in __call__|| | async with anyio.create_task_group() as task_group:|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\&quot;, line 680, in __aexit__|| | raise BaseExceptionGroup(|| | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)|| +-+---------------- 1 ----------------|| | Traceback (most recent call last):|| | File \&quot;/opt/microsoft-maas/miniconda/envs/proxy/lib/python3.11/site-packages/starlette/middleware/errors.py\&quot;, line 164,...&quot;,
   &quot;timestamp&quot;:&quot;2025-07-16T17:17:34.745Z&quot;,
   &quot;type&quot;:null
}
</code></pre>
<h2>Let's Get This Fixed!</h2>
<p>So, that‚Äôs the scoop, guys. A bug in the <strong><em>LibreChat update</em></strong> is causing issues with the Azure Inception Jais model due to an <code>unhashable type: 'dict'</code> error. Hopefully, by sharing this information, we can get the bug squashed and get back to smooth sailing with our Arabic language processing. If you have any insights or experience with this, please chime in! Let‚Äôs work together to get this resolved.</p>

                    </div>
                    <aside class="related-posts">
                        <div class="ad-sidebar container">
                            <!-- <div class="ad-wrapper">
    <span>Iklan Related</span>
</div> -->
                        </div>
                        <h2 class="related-posts-title">Related Posts</h2><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/cell-the-basic-unit-of">Cell: The Basic Unit Of Life Explained</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-07T01:31:24+00:00">Aug 7, 2025</time>
		                        <span class="view-count">
									38 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/greenboot-and-systemd-boost-your">Greenboot &amp; Systemd: Boost Your System Management</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-11T13:22:33+00:00">Aug 11, 2025</time>
		                        <span class="view-count">
									49 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/raising-quail-your-complete-beginners">Raising Quail: Your Complete Beginner&#39;s Guide</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-01T14:29:07+00:00">Aug 1, 2025</time>
		                        <span class="view-count">
									45 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/sa-board-for-people-practices">SA Board For People Practices Award 2020 Winner</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-08-04T06:51:48+00:00">Aug 4, 2025</time>
		                        <span class="view-count">
									47 views
		                        </span>
                            </div>
                        </article><article class="related-post">
                            <h3 class="related-post-title">
                                <a href="https://catatansoal.github.io/blog/-1753848498044">‡§ï‡•Å‡§ï‡•Ç ‡§è‡§´‡§è‡§Æ ‡§∏‡•á ‡§™‡•à‡§∏‡•á ‡§ï‡•à‡§∏‡•á ‡§µ‡§æ‡§™‡§∏ ‡§™‡§æ‡§è‡§Ç: ‡§Ü‡§∏‡§æ‡§® ‡§§‡§∞‡•Ä‡§ï‡§æ</a>
                            </h3>
                            <div class="meta">
                            	<time datetime="2025-07-30T04:08:18+00:00">Jul 30, 2025</time>
		                        <span class="view-count">
									44 views
		                        </span>
                            </div>
                        </article>
                    </aside>
                    <aside class="related-posts"></aside>
                </div>
            </div>
        </article>
        <a href="#" class="back-to-top" id="backToTop" title="Back to top">
        	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-up" viewBox="0 0 16 16">
			  <path fill-rule="evenodd" d="M3.646 11.854a.5.5 0 0 0 .708 0L8 8.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708M2.4 5.2c0 .22.18.4.4.4h10.4a.4.4 0 0 0 0-.8H2.8a.4.4 0 0 0-.4.4"/>
			</svg>
		</a>
    </main>
    <footer class="footer">
        <div class="container">
            <p>¬© 2025 Question Notes</p>
        </div>
    </footer>
    <script>
    	(() => {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            const toggleMenu = () => {
                navMenu.classList.toggle('nav-menu-active');
                navToggle.classList.toggle('nav-toggle-active');
            };
            const backToTopHandler = (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            navToggle.addEventListener('click', toggleMenu);
            document.getElementById('backToTop').addEventListener('click', backToTopHandler);
            window.addEventListener('pagehide', () => {
                navToggle.removeEventListener('click', toggleMenu);
                document.getElementById('backToTop').removeEventListener('click', backToTopHandler);
            });
        })();
		(() => {
            window.addEventListener("DOMContentLoaded", (event) => {
                const ellHljs = document.createElement("script");
                ellHljs.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js");
                ellHljs.onload = () => {
                    hljs.highlightAll();
                };
                document.querySelector("body").append(ellHljs);
                const ellFont = document.createElement("link");
                ellFont.setAttribute("href", "https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css");
                ellFont.setAttribute("rel", "stylesheet");
                document.querySelector("head").append(ellFont);
                window.addEventListener('pagehide', () => {
                    // ellHljs.remove();
                    ellFont.remove();
                });

            });
        })();
    </script>
    <!-- Histats.com  START  (aync)-->
<script type="text/javascript">var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4957095,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
(function() {
var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
hs.src = ('//s10.histats.com/js15_as.js');
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();</script>
<!-- Histats.com  END  -->
    
    
</body>
</html>